#Draw Front Wall#
#################
FrontWall<-function(xpos=0.5,ypos=0.5,fact=1,col="grey85"){
  polygon(x=c(xpos,xpos+fact,xpos+fact,xpos),y=c(ypos,ypos,1.4,1.4),lwd=2,col=col)
}
#######################################################################################
#######################################################################################

dev.new(width=9, height=7)
par(mfcol=c(1,1), mar=c(0,0,0,0), oma=c(0,0,0,0),xpd=T)
plot.new()

FrontWall(xpos=-0.145,ypos=0.45,fact=0.435);polygon(x=c(0.29,0.38,0.38,0.29),y=c(0.45,0.65,2,2),lwd=2,col="grey80")
FrontWall(xpos=0.71,ypos=0.45,fact=0.435);polygon(x=c(0.71,0.62,0.62,0.71),y=c(0.45,0.65,2,2),lwd=2,col="grey80")
FrontWall(xpos=0.38,ypos=0.65,fact=0.24)
polygon(x=c(0.42,0.58,0.58,0.42),y=c(0.65,0.65,1,1),col="darkgoldenrod",lwd=2)
points(x=0.43,y=0.83,pch=19,cex=1)
text(x=0.5,y=0.08,"Loading....")
rect(xleft=0.1,xright=0.9,ybottom=0,ytop=0.05)

#Draw Key - Object 2#
#####################
Key<-function(xpos=0.5,ypos=0.2,fact=1){
  
  points(x=xpos+0.03*fact,y=ypos,pch=21,cex=3*fact,lwd=8*fact,col="black")
  rect(xleft=xpos-0.05*fact,xright=xpos+0.012*fact,ybottom=ypos-0.01*fact,ytop=ypos+0.01*fact,col="black")
  rect(xleft=xpos-0.05*fact,xright=xpos-0.04*fact,ybottom=ypos-0.013*fact,ytop=ypos-0.03*fact,col="black")
  rect(xleft=xpos-0.03*fact,xright=xpos-0.02*fact,ybottom=ypos-0.013*fact,ytop=ypos-0.03*fact,col="black")
  
}
#######################################################################################
#######################################################################################

#Draw Map - Object 3#
#####################
MapMaze<-function(xpos=0.5,ypos=0.3,fact=1){
  
  rect(xleft=xpos-0.1*fact,xright=xpos+0.1*fact,ybottom=ypos-0.1*fact,ytop=ypos+0.1*fact,lwd=3*fact,col="lightgoldenrod2")
  points(x=xpos,y=ypos,pch=10,cex=7*fact,lwd=2*fact)
  text(x=c(xpos,xpos,xpos-0.08*fact,xpos+0.08*fact),y=c(ypos+0.08*fact,ypos-0.08*fact,ypos,ypos),c("N","S","W","E"),cex=0.6*fact)
}
#######################################################################################
#######################################################################################

rect(xleft=0.11,xright=0.13,ybottom=0.01,ytop=0.04,col="dodgerblue2",border=NA)
Key(xpos=0.5,ypos=0.3)
text(x=0.5,y=0.2,"Find the key to open the door!",cex=1.5)

#Intro#
#######
Intro<-function(){
  
  dev.new(width=9, height=7)
  par(mfcol=c(1,1), mar=c(0,0,0,0), oma=c(0,0,0,0),xpd=T)
  plot.new()
  
  colorintro<-gray.colors(1, start = 0.1, end = 0.1, gamma = 1, alpha = 0.05)
  
  for (i in 1:10){
    Pause(0.2)
    text(x=.5,y=.5,"The MazeR",cex=5,col=colorintro)
  }
  
  Pause(0.4)
  text(x=.7,y=.4,"by MattSen",cex=1,col="grey40")
  Pause(0.4)
  points(x=0,y=1,cex=9,col="grey40",pch=15)
  points(x=1,y=0,cex=9,col="grey40",pch=15)
  Pause(0.4)
  points(x=0.1,y=0.9,cex=9,col="grey40",pch=15)
  points(x=0.9,y=0.1,cex=9,col="grey40",pch=15)
  Pause(0.4)
  points(x=0.2,y=0.8,cex=9,col="grey40",pch=15)
  points(x=0.8,y=0.2,cex=9,col="grey40",pch=15)
  Pause(0.4)
  points(x=0.3,y=0.7,cex=9,col="grey40",pch=15)
  points(x=0.7,y=0.3,cex=9,col="grey40",pch=15)
  Pause(0.4)
  points(x=0.4,y=0.7,cex=9,col="grey40",pch=15)
  points(x=0.6,y=0.3,cex=9,col="grey40",pch=15)
  Pause(0.4)
  points(x=0.5,y=0.7,cex=9,col="grey40",pch=15)
  points(x=0.5,y=0.3,cex=9,col="grey40",pch=15)
  Pause(0.4)
  points(x=0.6,y=0.7,cex=9,col="grey40",pch=15)
  points(x=0.4,y=0.3,cex=9,col="grey40",pch=15)
  Pause(0.4)
  points(x=0.7,y=0.7,cex=9,col="grey40",pch=15)
  points(x=0.3,y=0.3,cex=9,col="grey40",pch=15)
  Pause(0.4)
  points(x=0.8,y=0.7,cex=9,col="grey40",pch=15)
  points(x=0.2,y=0.3,cex=9,col="darkolivegreen2",pch=15)
  Pause(0.4)
  points(x=0.9,y=0.7,cex=9,col="dodgerblue2",pch=15)
  points(x=0.1,y=0.3,cex=9,col="grey40",pch=15)
  Pause(0.4)
  points(x=1,y=0.7,cex=9,col="grey40",pch=15)
  points(x=0,y=0.3,cex=9,col="grey40",pch=15)
  Pause(0.4)
}
#######################################################################################
#######################################################################################

#Draw Gras#
###########
Gras<-function(xlim=c(0,1),ylim=c(0.01,0.8),height=0.005,density=100){
  xgras<-sample(seq(xlim[1],xlim[2],by=0.001),density)
  ygras<-sample(seq(ylim[1],ylim[2],by=0.001),density)
  
  for (i in 1:density){
    for (j in 1:3){
      lines(x=c(xgras[i],xgras[i]+sample(seq(-0.01,0.01,by=0.005),1)),
            y=c(ygras[i],(ygras[i]+(height/(ygras[i]*10)+0.03))),lwd=2,col="green")
    }
  }
  mush<-sample(c(T,F,F,F),1)
  fact<-0.5
  if (mush==T){
    xpos<-sample(seq(0.3,0.7,0.01),1)
    ypos<-sample(seq(0.25,0.3,0.01),1)
    polygon(x=c(xpos-0.03*fact,xpos-0.03*fact,xpos+0.03*fact,xpos+0.03*fact),y=c(ypos-0.25*fact,ypos-0.35*fact,ypos-0.35*fact,ypos-0.25*fact),col="antiquewhite2",border="black",lwd=4*fact)
    polygon(x=c(xpos-seq(-0.1,0.1,0.02)*fact),
            y=c(ypos-0.25*fact,
                ypos-0.20*fact,
                ypos-0.17*fact,
                ypos-0.15*fact,
                ypos-0.14*fact,
                ypos-0.13*fact,
                ypos-0.14*fact,
                ypos-0.15*fact,
                ypos-0.17*fact,
                ypos-0.20*fact,
                ypos-0.25*fact),col="red",border="black",lwd=4*fact)
    points(x=c(xpos-seq(-0.05,0.05,0.05)*fact),
           y=c(ypos-0.20*fact,
               ypos-0.17*fact,
               ypos-0.20*fact),
           col="antiquewhite2",pch=19,cex=1*fact)           
  }  
}
#######################################################################################
#######################################################################################

#Level#
#######
ChooseLevel<-function(Level=1){
  Game<-T
  Code<-c("honeydew","honeydew","honeydew")
  
  plot.new()
  
  color<-gray.colors(1, start = 0.9, end = 0.9, gamma = 1, alpha = 0.3)
  
  colfloor<-"darkolivegreen2"
  
  par(mfcol=c(1,1), mar=c(0,0,0,0), oma=c(0,0,0,0),bg="white",xpd=T)
  plot.new()
  
  polygon(x=c(-1,2,2,-1),y=c(-0.5,-0.5,0.8,0.8),col=colfloor,density=15,angle=0,border=NA)
  polygon(x=c(-1,2,2,-1),y=c(-0.5,-0.5,0.8,0.8),col=colfloor,density=15,angle=90,border=NA)
  
  abline(h=c(0.8,0.75,0.65,0.45,0.05))
  lines(x=c(0.075,0.45),y=c(0,0.8))
  lines(x=c(0.925,0.55),y=c(0,0.8))
  
  lines(x=c(-0.7,0.35),y=c(0.05,0.8))
  lines(x=c(1.7,0.65),y=c(0.05,0.8))
  
  lines(x=c(-1.5,0.25),y=c(0.05,0.8))
  lines(x=c(2.5,0.75),y=c(0.05,0.8))
  
  lines(x=c(-2.3,0.15),y=c(0.05,0.8))
  lines(x=c(3.3,0.85),y=c(0.05,0.8))
  
  points(x=0.77,0.96,col="yellow",pch=19,cex=10)
  polygon(x=c(-0.1,0,0.1,0.2,0.3,0.38,0.52,0.68,0.75,0.93,1.02,1.1),y=c(0.8,0.9,0.87,0.99,0.95,0.99,0.83,0.96,0.83,0.98,0.87,0.8)+0.02,col="white")
  polygon(x=c(-0.1,0,0.1,0.2,0.3,0.38,0.52,0.68,0.75,0.93,1.02,1.1),y=c(0.8,0.9,0.87,0.99,0.95,0.99,0.83,0.96,0.83,0.98,0.87,0.8),col="darkslategray3")
  Gras(density=100)
  
  text(y=sample(seq(0.85,1.1,by=0.01),30,replace=T),x=sample(seq(0,1,by=0.01),30,replace=T),".....",cex=50,col=color,xpd=T) 
  
  Sword(xpos=0.85,ypos=0.7,fact=0.5)
  
  text(x=0.3,y=0.86,"Levels",cex=3,col="black")
  
  #Level Choice
  points(x=c(0.1,0.1,0.1,0.1,0.3,0.3,0.3,0.3,0.5,0.5,0.5,0.5),y=rep(c(0.65,0.50,0.35,0.20),3),cex=9,col="black",bg=color,pch=22,lwd=2)
  text(x=c(0.1,0.1,0.1,0.1,0.3,0.3,0.3,0.3,0.5,0.5,0.5,0.5),y=rep(c(0.65,0.50,0.35,0.20),3),c(1:12),cex=3,col=c(rep("deepskyblue4",Level),rep("grey95",(12-Level))))
  
  #Code
  rect(xleft=0.6,xright=1,ybottom=0.13,ytop=0.48,col=color,lwd=2)
  points(x=seq(0.65,1,by=0.06),y=rep(0.25,6),pch=22,cex=3,col="black",bg=2:7)
  rect(xleft=0.63,xright=0.8,ybottom=0.15,ytop=0.2,col=color)
  rect(xleft=0.81,xright=0.97,ybottom=0.15,ytop=0.2,col=color)
  text(x=0.72,y=0.178,"ok",cex=1.2,col="deepskyblue4")
  text(x=0.89,y=0.178,"delete",cex=1.2,col="deepskyblue4")
  
  #Exit Button
  points(x=0.94,y=0.97,pch=19,cex=4,col="firebrick1")
  text(x=0.94,y=0.97,"x",cex=1.5)
  
  choose<-T
  while (choose==T){
    
    #Code
    points(x=rep(0.8,9),y=rep(0.37,9),cex=c(8,10,7,7,9,6,5,7,4),pch=c(17,18,20),col=Code)
    
    levChos<-locator(1)
    
    #Code input
    if (0.63<levChos$x & 0.67>levChos$x & 0.22<levChos$y & levChos$y<0.27){Code[which(Code=="honeydew")[1]]<-2}
    if (0.69<levChos$x & 0.73>levChos$x & 0.22<levChos$y & levChos$y<0.27){Code[which(Code=="honeydew")[1]]<-3}
    if (0.75<levChos$x & 0.79>levChos$x & 0.22<levChos$y & levChos$y<0.27){Code[which(Code=="honeydew")[1]]<-4}
    if (0.81<levChos$x & 0.85>levChos$x & 0.22<levChos$y & levChos$y<0.27){Code[which(Code=="honeydew")[1]]<-5}
    if (0.87<levChos$x & 0.91>levChos$x & 0.22<levChos$y & levChos$y<0.27){Code[which(Code=="honeydew")[1]]<-6}
    if (0.93<levChos$x & 0.97>levChos$x & 0.22<levChos$y & levChos$y<0.27){Code[which(Code=="honeydew")[1]]<-7}
    points(x=rep(0.8,9),y=rep(0.37,9),cex=c(8,10,7,7,9,6,5,7,4),pch=c(17,18,20),col=Code)
    
    #Delete
    if (0.81<levChos$x & 0.96>levChos$x & 0.15<levChos$y & levChos$y<0.2){Code<-c("honeydew","honeydew","honeydew")}
    #Ok
    if (0.63<levChos$x & 0.80>levChos$x & 0.15<levChos$y & levChos$y<0.2 & any(Code=="honeydew")==F){
      Level<-CodeInput(as.numeric(Code))        
      Code<-c("honeydew","honeydew","honeydew")
      text(x=c(0.1,0.1,0.1,0.1,0.3,0.3,0.3,0.3,0.5,0.5,0.5,0.5),y=rep(c(0.65,0.50,0.35,0.20),3),c(1:12),cex=3,col=c(rep("deepskyblue4",Level),rep("grey95",(12-Level))))
    }
      
    if (0.91<levChos$x & 0.96>levChos$x & 0.93<levChos$y & levChos$y<1){
      dev.off()
      run<-F
      Game<-F
      Grid<-NA
      Position<-NA
      Map<-NA
      Health<-NA
      Strength<-NA
      Inventory<-NA
      Level<-NA
      Text<-"End"
      return(list(Game,run,Grid,Position,Map,Health,Strength,Inventory,Level,Text))
    } 
    
    #Level1 - Get Started
    if(0.04<levChos$x & levChos$x<0.16 & 0.58<levChos$y & levChos$y<0.72 & Level>=1){
     
      m<-c(88,88,88,88,88,88,88,88,88,
           88,77,77,77,77,88,99,88,88,
           88,77,88,88,77,88,77,88,88,
           88,77,77,88,77,88,77,88,88,
           88,88,77,88,0,88,77,77,88,
           88,77,77,88,88,88,88,77,88,
           88,77,88,88,77,77,77,77,88,
           88,77,77,77,77,88,2,88,88,
           88,88,88,88,88,88,88,88,88)
      

      grid<-matrix(m,ncol=9,byrow=T)
      Text<-"Get Started!"
      Health<-1
      Strength<-0
      Inventory<-c(0,0,0)
      choose<-F
      Level<-1
    }
    
    #Level2 - The Map
    if(0.04<levChos$x & levChos$x<0.16 & 0.43<levChos$y & levChos$y<0.57 & Level>=2){
      
      
      m<-c(88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,
           88,77,77,77,88,77,88,88,77,77,77,77,77,77,88,88,
           88,77,88,77,88,77,88,88,77,88,88,88,88,77,88,88,
           88,77,88,77,88,77,77,77,77,88,88,88,88,77,88,88,
           88,2,88,77,88,77,88,88,77,88,88,88,88,77,88,88,
           88,88,88,77,77,77,88,88,77,77,77,77,88,77,88,88,
           88,77,77,77,88,77,77,88,77,88,88,77,77,77,88,88,
           88,88,77,88,88,88,77,88,77,88,88,77,88,77,88,88,
           88,77,77,77,77,88,77,88,77,77,77,77,88,77,88,88,
           88,77,88,88,77,88,77,88,77,88,88,88,88,77,88,88,
           88,77,88,88,3,88,77,77,77,88,77,77,77,77,88,88,
           88,77,88,88,77,88,77,88,77,88,77,88,88,88,88,88,
           88,77,77,77,77,77,77,88,77,88,77,88,88,88,99,88,
           88,77,88,88,77,88,77,88,77,77,77,77,88,88,77,88,
           88,77,88,88,0,88,77,88,88,77,88,77,77,77,77,88,
           88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88)
      
      grid<-matrix(m,ncol=16,byrow=T)
      Text<-"The Map"
      Health<-1
      Strength<-0
      Inventory<-c(0,0,0)
      choose<-F
      Level<-2
    }
    
    #Level3 - Fight!
    if(0.04<levChos$x & levChos$x<0.16 & 0.28<levChos$y & levChos$y<0.42 & Level>=3){
      
      m<-c(88,88,88,88,88,88,88,88,88,
           88,77,77,99,88,77,77,77,88,
           88,77,88,88,88,88,88,77,88,
           88,77,77,77,77,77,77,77,88,
           88,77,88,88,21,88,88,1,88,
           88,88,88,77,77,77,88,88,88,
           88,77,77,77,77,77,77,77,88,
           88,77,88,88,0,88,88,77,88,
           88,77,77,88,3,88,2,77,88,
           88,88,88,88,88,88,88,88,88)
      
      
      grid<-matrix(m,ncol=9,byrow=T)
      Text<-"Fight!"
      Health<-1
      Strength<-0
      Inventory<-c(0,0,0)
      choose<-F
      Level<-3
    }
        
    #Level4 - Lost
    if(0.04<levChos$x & levChos$x<0.16 & 0.13<levChos$y & levChos$y<0.27 & Level>=4){
      
      m<-c(88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,
           88,77,77,77,77,77,77,88,77,88,88,88,88,88,88,2,88,88,88,88,88,88,77,88,77,77,77,77,77,77,88,
           88,77,88,88,88,88,77,88,77,88,77,77,77,77,77,77,77,77,77,77,77,88,77,88,77,88,88,88,88,77,88,
           88,77,88,1,77,88,77,88,77,88,88,88,88,88,88,77,88,88,88,88,88,88,77,88,77,88,77,1,88,77,88,
           88,77,77,77,77,88,77,77,77,77,77,21,77,77,77,77,77,77,77,21,77,77,77,77,77,88,77,77,77,77,88,
           88,77,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,77,88,
           88,77,88,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,88,77,88,
           88,77,88,77,77,88,88,88,88,88,77,88,88,88,88,77,88,88,88,88,77,88,88,88,88,88,77,77,88,77,88,
           88,77,88,77,88,88,77,77,77,77,77,88,88,88,88,21,88,88,88,88,77,77,77,77,77,88,88,77,88,77,88,
           88,77,88,77,77,88,77,88,88,88,77,88,88,88,88,77,88,88,88,88,77,88,88,88,77,88,77,77,88,77,88,
           88,77,88,77,88,88,77,88,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,88,77,88,88,77,88,77,88,
           88,77,88,77,77,77,77,88,77,88,88,88,88,88,88,77,88,88,88,88,88,88,77,88,77,77,77,77,88,77,88,
           88,77,88,77,77,77,77,88,77,88,77,77,77,77,77,77,77,77,77,77,77,88,77,88,77,77,77,77,88,77,88,
           88,77,88,77,88,88,88,88,77,88,77,88,77,88,88,77,88,88,77,88,77,88,77,88,88,88,88,77,88,77,88,
           88,77,88,77,88,88,88,88,77,88,77,88,77,88,77,77,77,88,77,88,77,88,77,88,88,88,88,77,88,77,88,
           88,77,88,77,88,88,88,88,77,88,77,88,77,88,77,0,77,88,77,88,77,88,77,88,88,88,88,77,88,77,88,
           88,77,88,77,88,88,88,88,77,88,77,88,77,88,77,3,77,88,77,88,77,88,77,88,88,88,88,77,88,77,88,
           88,77,77,77,77,77,77,77,77,88,77,88,88,88,88,88,88,88,88,88,77,88,77,77,77,77,77,77,77,77,88,
           88,77,88,88,88,88,77,88,77,88,77,77,77,77,88,99,88,77,77,77,77,88,77,88,77,88,88,88,88,77,88,
           88,77,77,77,77,88,77,88,77,88,77,88,88,88,88,77,88,88,88,88,77,88,77,88,77,88,77,77,77,77,88,
           88,77,88,88,77,88,77,88,77,88,77,77,77,77,77,77,77,77,77,77,77,88,77,88,77,88,77,88,88,77,88,
           88,77,77,77,77,88,77,88,77,88,77,77,88,88,88,88,88,88,88,77,77,88,77,88,77,88,77,77,77,77,88,
           88,77,88,88,77,88,77,88,77,88,77,77,88,77,77,77,77,77,88,77,77,88,77,88,77,88,77,88,88,77,88,
           88,77,88,88,77,88,77,88,77,88,77,88,88,77,88,21,88,77,88,88,77,88,77,88,77,88,77,88,88,77,88,
           88,77,88,88,77,88,77,88,77,88,77,77,88,77,88,77,88,77,88,77,77,88,77,88,77,88,77,88,88,77,88,
           88,77,88,1,77,77,77,88,77,88,77,77,77,77,88,77,88,77,77,77,77,88,77,88,77,77,77,1,88,77,88,
           88,77,88,88,88,88,88,88,77,88,77,77,88,88,88,77,88,88,88,77,77,88,77,88,88,88,88,88,88,77,88,
           88,77,77,77,88,77,77,77,77,77,77,77,77,77,88,88,88,77,77,77,77,77,77,77,77,88,77,77,77,77,88,
           88,77,88,88,88,88,88,88,88,88,88,88,88,88,88,77,88,88,88,88,88,88,88,88,88,88,88,88,88,77,88,
           88,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,88,
           88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88)
            
      grid<-matrix(m,ncol=31,byrow=T)
      Text<-"Lost"
      Health<-1
      Strength<-0
      Inventory<-c(0,0,0)
      choose<-F
      Level<-4
    }
        
    #Level5 - Turn off the Lights
    if(0.24<levChos$x & levChos$x<0.36 & 0.58<levChos$y & levChos$y<0.72 & Level>=5){
      
      m<-c(88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,
           88,88,88,88,88,88,77,77,77,77,78,77,88,99,88,
           88,88,88,88,88,88,77,88,88,88,88,78,88,77,88,
           88,88,88,88,88,88,77,77,77,88,88,78,88,77,88,
           88,88,88,88,88,88,88,88,77,88,88,78,77,78,88,
           88,88,88,88,88,88,88,88,78,88,88,77,88,88,88,
           88,88,88,88,88,77,77,77,77,88,88,78,88,77,88,
           88,88,8,88,88,88,88,88,78,88,88,78,88,77,88,
           88,88,77,88,88,88,88,88,77,88,88,77,88,77,88,
           88,77,77,88,88,88,88,88,78,88,88,78,77,78,88,
           88,88,77,77,78,77,78,77,78,88,88,88,88,77,88,
           88,88,77,88,88,88,88,88,78,88,88,88,88,77,88,
           88,88,77,77,77,77,77,88,77,78,78,2,88,77,88,
           88,88,0,88,88,88,88,88,78,88,88,88,88,77,88,
           88,88,88,88,88,88,88,88,88,88,88,88,88,88,88
      )
            
      grid<-matrix(m,ncol=15,byrow=T)
      Text<-"Turn off the Lights"
      Health<-1
      Strength<-0
      Inventory<-c(0,0,0)
      choose<-F
      Level<-5
    }
    
    #Level6 - Go Outside
    if(0.24<levChos$x & levChos$x<0.36 & 0.43<levChos$y & levChos$y<0.57 & Level>=6){
      
      m<-c(87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,
           87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,
           87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,
           87,87,87,77,77,77,87,77,77,77,77,77,77,77,87,77,77,77,87,87,87,
           87,87,87,77,77,77,87,77,77,88,88,88,77,77,87,77,77,77,87,87,87,
           87,87,87,77,77,77,87,77,77,88,99,88,77,77,87,77,77,77,87,87,87,
           87,87,87,77,77,77,77,77,77,88,77,88,77,77,77,77,77,77,87,87,87,
           87,87,87,77,77,87,77,77,77,88,21,88,77,77,77,87,77,77,87,87,87,
           87,87,87,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,87,87,87,
           87,87,87,87,87,77,77,77,77,77,77,77,77,77,77,77,87,87,87,87,87,
           87,87,87,77,77,77,77,88,88,88,88,88,88,88,77,77,77,77,87,87,87,
           87,87,87,77,77,77,77,88,77,77,77,77,77,88,77,77,77,77,87,87,87,
           87,87,87,77,77,77,77,77,77,88,77,88,77,77,77,77,77,77,87,87,87,
           87,87,87,89,77,89,77,88,88,88,77,88,88,88,77,89,77,89,87,87,87,
           87,87,87,89,77,89,77,88,77,77,77,77,77,88,77,89,77,89,87,87,87,
           87,87,87,89,3,89,77,88,77,77,0,77,77,88,77,89,2,89,87,87,87,
           87,87,87,89,89,89,77,88,88,88,88,88,88,88,77,89,89,89,87,87,87,
           87,87,87,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,87,87,87,
           87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,
           87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,
           87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87
      )
      
      grid<-matrix(m,ncol=21,byrow=T)
      Text<-"Go Outside!"
      Health<-1
      Strength<-0
      Inventory<-c(0,0,0)
      choose<-F
      Level<-6
    }
    
    #Level7 - Bridges
    if(0.24<levChos$x & levChos$x<0.36 & 0.28<levChos$y & levChos$y<0.42 & Level>=7){
      
      m<-c(87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,
           87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,
           87,87,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,1,87,87,
           87,87,77,21,77,77,77,77,77,77,77,21,77,77,77,88,88,88,77,87,87,
           87,87,77,77,77,77,77,77,77,77,77,77,77,77,77,88,99,88,77,87,87,
           87,87,77,77,77,77,77,77,77,77,77,77,77,77,77,88,77,88,77,87,87,
           87,87,77,77,77,77,77,21,77,77,77,77,77,77,77,77,77,77,77,87,87,
           87,87,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,21,87,87,
           87,87,31,87,77,77,87,88,88,88,77,88,88,88,88,88,88,88,88,87,87,
           87,87,77,1,87,77,77,88,4,77,77,77,77,77,77,77,77,77,88,87,87,
           87,87,77,77,77,87,77,88,77,77,77,77,77,88,77,88,88,77,88,87,87,
           87,87,77,87,77,31,77,88,77,77,77,77,77,88,77,77,77,77,88,87,87,
           87,87,77,77,77,87,77,88,88,88,88,88,88,88,77,88,88,88,88,87,87,
           87,87,77,77,77,31,77,77,87,77,77,77,87,77,77,77,87,87,87,87,87,
           87,87,87,87,87,87,87,77,87,77,87,77,87,77,77,77,87,87,87,87,87,
           87,87,77,77,77,3,87,77,87,31,87,77,87,87,77,87,87,87,4,87,87,
           87,87,77,77,77,77,87,2,87,77,87,77,77,77,77,77,77,87,77,87,87,
           87,87,77,0,77,77,87,87,87,77,87,87,87,87,87,87,87,87,77,87,87,
           87,87,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,87,87,
           87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,
           87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87
           
      )
      
      grid<-matrix(m,ncol=21,byrow=T)
      Text<-"Bridges"
      Health<-1
      Strength<-0
      Inventory<-c(0,0,0)
      choose<-F
      Level<-7
    }  
    
    #Level8 - Not Enough!
    if(0.24<levChos$x & levChos$x<0.36 & 0.13<levChos$y & levChos$y<0.27 & Level>=8){
      
      m<-c(87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,
           87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,
           87,87,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,87,87,
           87,87,77,77,77,77,77,77,88,88,88,88,88,88,88,88,88,88,88,87,87,
           87,87,77,77,87,77,77,77,88,88,88,88,88,99,88,88,88,88,88,87,87,
           87,87,77,77,77,77,77,77,88,77,77,77,77,77,77,77,77,88,88,87,87,
           87,87,77,77,77,77,22,77,77,77,88,88,88,77,88,88,77,88,88,87,87,
           87,87,77,77,77,77,77,77,88,77,77,77,77,77,77,77,77,88,88,87,87,
           87,87,89,89,89,77,77,77,88,88,88,88,88,77,88,88,88,88,88,87,87,
           87,87,89,77,31,77,77,77,88,88,88,88,88,77,88,88,88,88,88,87,87,
           87,87,89,77,89,87,87,87,87,87,77,77,77,77,77,77,77,77,77,87,87,
           87,87,89,77,89,87,77,77,77,87,87,87,87,87,87,87,87,87,77,87,87,
           87,87,89,77,89,87,77,21,77,77,31,77,77,77,31,77,77,87,2,87,87,
           87,87,89,77,89,87,77,77,77,77,87,77,87,87,87,87,77,87,87,87,87,
           87,87,77,77,6,87,77,77,87,87,87,77,77,77,77,87,77,77,3,87,87,
           87,87,77,87,87,87,77,1,87,4,87,87,87,87,87,87,77,87,87,87,87,
           87,87,77,77,77,77,77,87,87,77,77,77,77,31,77,77,77,87,77,87,87,
           87,87,77,87,77,87,77,77,87,77,87,87,87,87,87,87,87,87,77,87,87,
           87,87,77,77,77,77,77,77,87,0,87,77,77,77,77,77,77,77,77,87,87,
           87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,
           87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87)
      
      grid<-matrix(m,ncol=21,byrow=T)
      Text<-"Not Enough!"
      Health<-1
      Strength<-0
      Inventory<-c(0,0,0)
      choose<-F
      Level<-8
    }   
    
    #Level9 - Get Stronger!
    if(0.44<levChos$x & levChos$x<0.56 & 0.58<levChos$y & levChos$y<0.72 & Level>=9){
      
      m<-c(88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,
           88,88,88,88,77,77,77,77,77,77,77,77,77,77,88,
           88,88,88,88,77,88,88,88,77,23,77,88,88,77,88,
           88,88,88,88,77,88,88,88,77,77,77,88,88,77,88,
           88,77,77,21,77,88,88,88,88,77,88,88,88,2,88,
           88,77,88,88,88,88,3,88,88,77,88,88,88,88,88,
           88,77,77,99,88,88,77,88,88,77,77,77,77,77,88,
           88,88,88,88,88,88,77,88,88,77,88,88,88,77,88,
           88,88,88,88,88,88,77,88,88,22,88,88,88,77,88,
           88,88,5,77,77,77,77,88,88,77,88,88,88,1,88,
           88,88,88,88,88,88,77,88,88,77,88,88,88,88,88,
           88,1,77,77,88,88,77,77,77,77,88,77,77,77,88,
           88,77,88,77,77,77,77,88,88,88,88,77,88,77,88,
           88,0,77,77,88,88,77,77,77,77,77,77,88,6,88,
           88,88,88,88,88,88,88,88,88,88,88,88,88,88,88)
      
      grid<-matrix(m,ncol=15,byrow=T)
      Text<-"Get Stronger!"
      Health<-1
      Strength<-0
      Inventory<-c(0,0,0)
      choose<-F
      Level<-9
    } 
    
    #Level10 - Find the Door or Die!
    if(0.44<levChos$x & levChos$x<0.56 & 0.43<levChos$y & levChos$y<0.57 & Level>=10){
      
      m<-c(88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,
           88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,
           88,88,88,88,88,88,77,88,77,88,77,88,88,88,88,88,88,
           88,88,88,88,88,88,77,88,77,88,77,88,88,88,88,88,88,
           88,88,88,88,88,88,78,88,78,88,78,88,88,88,88,88,88,
           88,88,88,88,88,88,78,88,78,88,78,88,88,88,88,88,88,
           88,88,88,88,88,88,78,88,78,88,78,88,88,88,88,88,88,
           88,88,88,88,88,88,31,88,31,88,31,88,88,88,88,88,88,
           88,88,88,88,88,88,78,88,78,88,78,88,88,88,88,88,88,
           88,88,88,88,88,88,78,88,78,88,78,88,88,88,88,88,88,
           88,88,88,88,88,88,77,88,77,88,77,88,88,88,88,88,88,
           88,88,88,88,88,88,77,88,77,88,77,88,88,88,88,88,88,
           88,88,88,88,88,88,77,78,77,78,77,88,88,88,88,88,88,
           88,88,88,88,88,88,77,77,77,77,77,88,88,88,88,88,88,
           88,88,88,88,88,88,88,88,77,88,88,88,88,88,88,88,88,
           88,88,88,88,88,88,88,88,0,88,88,88,88,88,88,88,88,
           88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88)
      
      grid<-matrix(m,ncol=17,byrow=T)
      
      random<-sample(c(1,2,3),2)
      
      grid[8,c(7,9,11)[random[1]]]<-78
      grid[8,c(7,9,11)[random[2]]]<-78
      
      grid[2,c(7,9,11)[random[1]]]<-99
      grid[2,c(7,9,11)[random[2]]]<-2
      
      Text<-"Find the Door or Die!"
      Health<-1
      Strength<-0
      Inventory<-c(0,0,0)
      choose<-F
      Level<-10
    }    
    
    #Level11 - Cabin in the Woods
    if(0.44<levChos$x & levChos$x<0.56 & 0.28<levChos$y & levChos$y<0.42 & Level>=11){
      
      m<-c(87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,88,88,88,88,88,88,88,88,88,88,88,
           87,77,77,31,77,77,1,77,87,4,77,87,87,87,87,87,87,77,87,87,88,77,77,77,77,77,77,77,77,77,88,
           87,77,89,89,89,89,89,77,87,87,77,87,87,77,77,77,77,77,77,77,77,77,88,77,88,88,88,88,88,77,88,
           87,77,89,77,77,77,89,77,87,77,77,77,87,77,87,77,87,87,87,87,88,77,88,77,88,88,88,88,88,77,88,
           87,77,89,77,2,77,89,77,87,77,87,87,87,77,87,87,87,87,77,77,88,77,88,77,77,77,77,77,77,77,88,
           87,77,89,77,77,77,89,31,87,77,77,77,77,77,77,77,77,77,77,87,88,88,88,88,88,88,88,88,77,77,88,
           87,77,89,89,21,89,89,77,87,77,87,87,87,77,87,87,87,87,77,87,88,77,88,77,77,77,77,77,77,77,88,
           87,77,77,77,77,77,77,77,87,77,87,87,87,21,87,87,77,87,77,87,88,77,88,77,88,88,88,88,88,77,88,
           87,77,87,87,87,87,87,87,87,77,87,87,87,77,87,87,77,87,77,87,88,77,77,77,77,77,77,88,77,77,88,
           87,31,87,77,87,87,77,77,77,77,77,77,87,77,87,87,77,87,77,87,88,88,88,88,88,77,77,88,77,77,88,
           87,77,87,77,87,87,87,87,87,87,87,77,87,87,87,87,77,77,77,87,88,77,77,77,77,77,77,88,77,77,88,
           87,77,87,77,87,87,87,87,77,77,77,77,87,87,77,87,77,87,77,87,88,77,88,88,88,88,88,88,88,88,88,
           87,77,77,77,77,77,87,87,87,87,87,87,87,87,77,87,77,87,77,87,88,77,88,77,88,77,77,88,77,77,88,
           87,87,77,87,87,87,87,77,77,77,77,77,77,77,77,77,77,87,77,87,88,77,88,77,88,88,77,88,77,88,88,
           87,87,77,87,87,77,87,77,87,87,87,87,87,87,77,87,77,87,77,87,88,77,77,77,77,77,77,77,77,77,88,
           87,87,77,77,77,77,87,77,87,87,77,77,77,87,77,87,77,87,77,87,88,88,88,88,88,77,77,77,88,77,88,
           87,87,77,87,87,77,87,77,87,87,77,77,77,87,77,77,77,77,77,87,88,77,5,88,77,77,88,77,88,77,88,
           87,77,21,77,77,77,77,77,77,77,77,77,77,87,87,87,87,87,77,77,77,77,77,88,77,77,88,77,88,77,88,
           87,87,87,87,77,87,87,77,87,87,77,77,77,77,77,77,77,87,77,87,88,77,4,88,88,77,88,77,88,77,88,
           87,77,77,77,77,87,87,87,87,87,87,87,87,87,87,87,87,87,77,87,88,88,88,88,88,77,88,77,88,77,88,
           88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,77,88,88,77,88,77,88,77,88,77,88,77,88,
           88,77,77,77,77,77,77,77,77,77,77,88,77,77,77,77,77,88,77,88,77,77,77,77,77,77,88,77,77,77,88,
           88,77,88,88,88,77,88,88,77,88,88,88,88,88,88,77,77,88,77,88,77,88,88,88,88,88,88,88,88,77,88,
           88,77,77,88,1,77,88,77,77,77,77,88,77,77,88,88,77,88,77,88,77,77,77,77,77,77,88,77,77,77,88,
           88,77,88,88,88,88,88,88,88,88,88,88,88,77,88,77,77,88,77,88,88,88,88,88,88,88,88,88,88,77,88,
           88,77,77,88,77,77,88,77,77,77,77,77,77,77,88,77,77,88,77,77,77,31,77,77,77,77,77,77,88,77,88,
           88,77,88,88,77,88,88,77,88,88,88,77,88,88,88,88,77,88,88,88,88,88,88,88,88,77,88,77,88,77,88,
           88,77,77,77,77,77,88,77,77,77,88,77,77,88,3,77,77,77,77,77,77,77,77,77,88,77,77,77,88,77,88,
           88,77,88,88,88,88,88,88,77,88,88,88,77,88,88,77,77,88,88,88,77,88,88,77,88,88,88,88,88,77,88,
           88,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,0,88,
           88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88)
      
      grid<-matrix(m,ncol=31,byrow=T)
      Text<-"Cabin in the Woods"
      Health<-1
      Strength<-0
      Inventory<-c(0,0,0)
      choose<-F
      Level<-11
    } 
    
    #Level12 - Don't Turn Around!
    if(0.44<levChos$x & levChos$x<0.56 & 0.13<levChos$y & levChos$y<0.27 & Level>=12){
      
      m<-c(88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,
           88,77,77,77,77,77,77,77,77,77,77,77,77,77,6,77,77,77,77,77,77,77,77,77,77,77,77,77,88,88,88,
           88,77,88,88,88,77,88,88,88,88,88,88,88,88,77,88,88,88,77,88,88,88,88,88,88,88,88,77,88,88,88,
           88,77,88,88,88,77,88,88,88,88,88,88,88,88,77,88,88,88,77,88,21,77,77,88,88,88,88,77,88,88,88,
           88,77,88,88,88,77,88,88,88,88,88,88,88,88,78,88,88,88,77,88,88,88,77,77,77,77,77,77,88,88,88,
           88,77,77,77,77,77,77,77,77,77,88,88,88,88,78,88,88,88,77,77,77,88,77,88,77,88,88,77,88,88,88,
           88,77,88,88,88,77,88,88,88,77,88,88,88,88,78,88,88,88,77,88,88,88,77,88,77,88,88,77,88,88,88,
           88,77,88,88,88,77,88,88,88,77,88,88,88,88,23,88,88,88,77,88,88,88,77,88,77,88,88,77,88,88,88,
           88,77,88,88,88,77,88,88,88,77,88,88,88,88,78,88,88,88,77,77,1,88,77,88,77,77,77,77,88,88,88,
           88,77,88,88,88,77,23,77,77,77,99,88,88,88,78,88,88,88,88,77,88,88,77,88,88,88,88,77,88,88,88,
           88,77,88,88,88,88,88,88,88,88,88,88,88,88,78,88,88,88,88,77,77,77,77,88,88,88,88,77,88,88,88,
           88,77,88,88,88,88,88,88,88,88,88,88,88,88,78,88,88,88,88,88,88,88,88,88,88,88,88,77,88,88,88,
           88,77,88,88,88,88,88,88,88,88,88,88,77,77,77,77,77,88,88,88,88,88,88,88,88,88,88,77,88,88,88,
           88,77,88,88,88,88,88,88,88,88,88,88,77,77,77,77,77,88,88,88,88,88,88,88,88,88,88,77,88,88,88,
           88,5,77,77,78,78,78,23,78,78,78,78,77,77,0,77,77,78,78,78,78,23,78,78,78,77,77,1,88,88,88,
           88,77,88,88,88,88,88,88,88,88,88,88,77,77,77,77,77,88,88,88,88,88,88,88,88,88,88,77,88,88,88,
           88,77,88,88,88,88,88,88,88,88,88,88,77,77,77,77,77,88,88,88,88,88,88,88,88,88,88,77,88,88,88,
           88,77,88,88,88,88,88,88,88,88,88,88,88,88,78,88,88,88,88,88,88,88,88,88,88,88,88,77,88,88,88,
           88,77,88,88,88,88,88,88,88,88,88,88,88,88,78,88,88,88,77,77,77,77,77,77,88,88,88,77,88,88,88,
           88,77,77,77,77,77,77,77,21,88,88,88,88,88,78,88,88,88,77,88,88,88,88,77,88,88,88,77,88,88,88,
           88,77,88,88,77,88,77,88,77,88,88,88,88,88,78,88,88,88,77,77,77,2,88,77,88,88,88,77,88,88,88,
           88,77,77,77,77,88,77,88,77,88,88,88,88,88,23,88,88,88,88,88,88,88,88,77,77,77,77,77,88,88,88,
           88,77,88,88,88,88,77,88,77,88,88,88,88,88,78,88,88,88,22,77,77,77,88,77,88,88,88,77,88,88,88,
           88,77,77,77,77,88,8,88,77,77,77,77,88,88,78,88,88,88,77,88,88,77,88,77,88,88,88,77,88,88,88,
           88,77,88,88,77,88,88,88,77,88,88,77,88,88,78,88,88,88,77,88,88,77,77,77,88,88,88,77,88,88,88,
           88,77,88,88,77,88,88,88,77,88,88,77,88,88,77,88,88,88,77,88,88,88,88,88,88,88,88,77,88,88,88,
           88,77,88,88,77,88,88,88,77,88,88,77,88,88,77,88,88,88,77,88,88,88,88,88,88,88,88,77,88,88,88,
           88,77,77,77,77,77,77,77,77,77,77,77,77,77,3,77,77,77,77,77,77,77,77,77,77,77,77,77,88,88,88,
           88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,
           88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,
           88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88)
      
      grid<-matrix(m,ncol=31,byrow=T)
      Text<-"Don't Turn Around!"
      Health<-1
      Strength<-0
      Inventory<-c(0,0,0)
      choose<-F
      Level<-12
    }
    
    if (choose==F){
      #Add Extra Layers
      Grid<-rbind(77,77,77,77,77,77,grid,77,77,77,77,77,77)
      Grid<-cbind(77,77,77,77,77,77,Grid,77,77,77,77,77,77)
      position.x<-which(Grid == 0, arr.ind = TRUE)[2] #First Def of Position
      position.y<-which(Grid == 0, arr.ind = TRUE)[1] #First Def of Position
      Grid[position.y,position.x]<-77
      
      Map<-Grid
      Map[,]<-NA
      
      Position<-Map
      Position[position.y,position.x]<-1
      run<-T    
      
      return(list(Game,run,Grid,Position,Map,Health,Strength,Inventory,Level,Text))      
    }
    if (Game==F){
     choose<-F      
    }
    
  }
} 
#######################################################################################
#######################################################################################

#Title Function#
################
Title<-function(Text="End"){
  plot.new()
  par(mfcol=c(1,1), mar=c(0,0,0,0), oma=c(0,0,0,0),xpd=T) 
  colorintro<-gray.colors(1, start = 0.1, end = 0.1, gamma = 1, alpha = 0.05)
  rect(xleft=-0.5,xright=1.5,ybottom=-0.5,ytop=1.5,col="black")
  text(x=.5,y=.5,Text,cex=2,col="white") 
  Pause(3)
  
  if (Text=="End") dev.off()  
}
#######################################################################################
#######################################################################################

#CodeInput#
###########
CodeInput<-function(Code){
  
  if (sum(abs(Code-c(5,7,4)))==0){Level<-2}
  if (sum(abs(Code-c(5,6,4)))==0){Level<-3}
  if (sum(abs(Code-c(7,3,4)))==0){Level<-4}
  if (sum(abs(Code-c(4,2,6)))==0){Level<-5}
  if (sum(abs(Code-c(2,5,4)))==0){Level<-6}
  if (sum(abs(Code-c(5,6,3)))==0){Level<-7}
  if (sum(abs(Code-c(7,4,6)))==0){Level<-8}
  if (sum(abs(Code-c(7,5,6)))==0){Level<-9}
  if (sum(abs(Code-c(4,2,5)))==0){Level<-10}
  if (sum(abs(Code-c(5,7,3)))==0){Level<-11}
  if (sum(abs(Code-c(6,2,5)))==0){Level<-12}
  
  return(Level)
}
#######################################################################################
#######################################################################################

rect(xleft=0.11,xright=0.26,ybottom=0.01,ytop=0.04,col="dodgerblue2",border=NA)

#Basic View#
############
BasicView<-function(view){

color<-gray.colors(1, start = 0.9, end = 0.9, gamma = 1, alpha = 0.3)
  
colfloor<-"grey90"

if (length(which(view[4:6,4:6]==87))>0) colfloor<-"darkolivegreen2"
if (length(which(view[4:6,4:6]==88))==0) colfloor<-"darkolivegreen2"
if (length(which(view[4:6,4:6]==89))>0) colfloor<-"darkolivegreen2"

  
par(mfcol=c(1,1), mar=c(0,0,0,0), oma=c(0,0,0,0),bg="white",xpd=T)
plot.new()

polygon(x=c(-1,2,2,-1),y=c(-0.5,-0.5,0.8,0.8),col=colfloor,density=15,angle=0,border=NA)
polygon(x=c(-1,2,2,-1),y=c(-0.5,-0.5,0.8,0.8),col=colfloor,density=15,angle=90,border=NA)

abline(h=c(0.8,0.75,0.65,0.45,0.05))
lines(x=c(0.075,0.45),y=c(0,0.8))
lines(x=c(0.925,0.55),y=c(0,0.8))

lines(x=c(-0.7,0.35),y=c(0.05,0.8))
lines(x=c(1.7,0.65),y=c(0.05,0.8))

lines(x=c(-1.5,0.25),y=c(0.05,0.8))
lines(x=c(2.5,0.75),y=c(0.05,0.8))

lines(x=c(-2.3,0.15),y=c(0.05,0.8))
lines(x=c(3.3,0.85),y=c(0.05,0.8))

if (length(which(view[1:2,1:9]==88))==0 & length(which(view[1:2,1:9]==89))==0){
  points(x=0.77,0.96,col="yellow",pch=19,cex=10)
  polygon(x=c(-0.1,0,0.1,0.2,0.3,0.38,0.52,0.68,0.75,0.93,1.02,1.1),y=c(0.8,0.9,0.87,0.99,0.95,0.99,0.83,0.96,0.83,0.98,0.87,0.8)+0.02,col="white")
  polygon(x=c(-0.1,0,0.1,0.2,0.3,0.38,0.52,0.68,0.75,0.93,1.02,1.1),y=c(0.8,0.9,0.87,0.99,0.95,0.99,0.83,0.96,0.83,0.98,0.87,0.8),col="darkslategray3")
}

if (length(which(view[3:7,3:7]==88))<6 & length(which(view[3:7,3:7]==89))<6){
   Gras(density=80)
 }

text(y=sample(seq(0.85,1.1,by=0.01),30,replace=T),x=sample(seq(0,1,by=0.01),30,replace=T),".....",cex=50,col=color,xpd=T) 

}
#######################################################################################
#######################################################################################

#InteractFields#
#################
InteractFields<-function(Inventory,Health,Strength){
  
arrows(x0=0.55,x1=0.6,y0=0.01,y1=0.01,lwd=16,col="firebrick1")
arrows(x0=0.55,x1=0.6,y0=0.01,y1=0.01,lwd=12,col=1)

arrows(x0=0.45,x1=0.4,y0=0.01,y1=0.01,lwd=16,col="firebrick1")
arrows(x0=0.45,x1=0.4,y0=0.01,y1=0.01,lwd=12,col=1)

arrows(x0=0.5,x1=0.5,y0=0.01,y1=0.08,lwd=16,col="firebrick1")
arrows(x0=0.5,x1=0.5,y0=0.01,y1=0.08,lwd=12,col=1)

points(x=0.94,y=0.97,pch=19,cex=4,col="firebrick1")
text(x=0.94,y=0.97,"x",cex=1.5)

#Inventory Boxes
rect(xleft=-0.025, ybottom=0.95, xright=0.275, ytop=1.02,lwd=3,col="honeydew")
text(x=0.125,y=0.98,"Inventory",cex=1.5)
rect(xleft=-0.025, ybottom=0.85, xright=0.075, ytop=.95,lwd=3,col="honeydew")
rect(xleft=0.075, ybottom=0.85, xright=0.175, ytop=.95,lwd=3,col="honeydew")
rect(xleft=0.175, ybottom=0.85, xright=0.275, ytop=.95,lwd=3,col="honeydew")

#Object 1
if (Inventory[1]==1) Medikit(xpos=0.025,ypos=0.9,fact=0.4)
if (Inventory[2]==1) Medikit(xpos=0.125,ypos=0.9,fact=0.4)
if (Inventory[3]==1) Medikit(xpos=0.225,ypos=0.9,fact=0.4)
#Object 2
if (Inventory[1]==2) Key(xpos=0.025,ypos=0.9,fact=0.7)
if (Inventory[2]==2) Key(xpos=0.125,ypos=0.9,fact=0.7)
if (Inventory[3]==2) Key(xpos=0.225,ypos=0.9,fact=0.7)
#Object 3
if (Inventory[1]==3) MapMaze(xpos=0.025,ypos=0.9,fact=0.4)
if (Inventory[2]==3) MapMaze(xpos=0.125,ypos=0.9,fact=0.4)
if (Inventory[3]==3) MapMaze(xpos=0.225,ypos=0.9,fact=0.4)
#Object 4
if (Inventory[1]==4) Wood(xpos=0.02,ypos=0.92,fact=0.2)
if (Inventory[2]==4) Wood(xpos=0.12,ypos=0.92,fact=0.2)
if (Inventory[3]==4) Wood(xpos=0.22,ypos=0.92,fact=0.2)
#Object 5
if (Inventory[1]==5) Hammer(xpos=0.029,ypos=0.92,fact=0.39)
if (Inventory[2]==5) Hammer(xpos=0.129,ypos=0.92,fact=0.39)
if (Inventory[3]==5) Hammer(xpos=0.229,ypos=0.92,fact=0.39)
#Object 6
if (Inventory[1]==6) Sword(xpos=0.025,ypos=0.95,fact=0.2)
if (Inventory[2]==6) Sword(xpos=0.125,ypos=0.95,fact=0.2)
if (Inventory[3]==6) Sword(xpos=0.225,ypos=0.95,fact=0.2)
#Object 8
if (Inventory[1]==8) Torch(xpos=0.025,ypos=0.89,fact=0.12)
if (Inventory[2]==8) Torch(xpos=0.125,ypos=0.89,fact=0.12)
if (Inventory[3]==8) Torch(xpos=0.225,ypos=0.89,fact=0.12)


healthcol<-"darkolivegreen3"
if (Health<0.66) healthcol<-"darkorange1"
if (Health<0.33) healthcol<-"brown1"
text(x=0.2401,y=0.001,expression(bold("Health")),cex=1.2,col="white")
text(x=0.2401,y=-0.001,expression(bold("Health")),cex=1.2,col="white")
text(x=0.2399,y=0.001,expression(bold("Health")),cex=1.2,col="white")
text(x=0.2399,y=-0.001,expression(bold("Health")),cex=1.2,col="white")
text(x=0.24,y=0,expression(bold("Health")),cex=1.2,col="black")
rect(xleft=-0.015, ybottom=0.025, xright=0.295,border="white", ytop=0.085,lwd=3)
rect(xleft=-0.01, ybottom=0.03, xright=0.29,col="white", ytop=0.08,lwd=3)
rect(xleft=-0.006, ybottom=0.033, xright=0.288*Health,bg=NA, ytop=0.075,lwd=3,col=healthcol,border=NA)

strengthcol<-"darkolivegreen3"
if (Strength<0.66) strengthcol<-"darkorange1"
if (Strength<0.33) strengthcol<-"brown1"
text(x=0.7601,y=0.001,expression(bold("Strength")),cex=1.2,col="white")
text(x=0.7601,y=-0.001,expression(bold("Strength")),cex=1.2,col="white")
text(x=0.7599,y=0.001,expression(bold("Strength")),cex=1.2,col="white")
text(x=0.7599,y=-0.001,expression(bold("Strength")),cex=1.2,col="white")
text(x=0.76,y=0,expression(bold("Strength")),cex=1.2,col="black")
rect(xleft=0.675, ybottom=0.025, xright=0.985,border="white", ytop=0.085,lwd=3)
rect(xleft=0.68, ybottom=0.03, xright=0.98,col="white", ytop=0.08,lwd=3)
rect(xleft=0.684, ybottom=0.033, xright=0.684+0.294*Strength,bg=NA, ytop=0.075,lwd=3,col=strengthcol,border=NA)
}
#######################################################################################
#######################################################################################

#Draw MediKit - Object 1#
#########################
Medikit<-function(xpos=0.5,ypos=0.3,fact=1){
  
  rect(xleft=xpos-0.1*fact,xright=xpos+0.1*fact,ybottom=ypos-0.08*fact,ytop=ypos+0.08*fact,lwd=2,col="white")
  text(x=xpos,y=ypos,"+",col="red",cex=6*fact)
  
}
#######################################################################################
#######################################################################################

#Draw Sword - Object 6 #
########################
Sword<-function(xpos=0.5,ypos=0.5,fact=1){
  
  polygon(x=c(xpos-0.2*fact,xpos-0.16*fact,xpos+0.11*fact,xpos+0.13*fact),y=c(ypos-0.24*fact,ypos-0.28*fact,ypos-0.34*fact,ypos-0.32*fact),col="grey90",lwd=2*fact)
  polygon(x=c(xpos-0.2*fact,xpos-0.14*fact,xpos+0.14*fact,xpos+0.13*fact),y=c(ypos-0.24*fact,ypos-0.23*fact,ypos-0.30*fact,ypos-0.32*fact),col="grey95",lwd=2*fact)
  polygon(x=c(xpos+0.13*fact,xpos+0.14*fact,xpos+0.2*fact,xpos+0.195*fact),y=c(ypos-0.33*fact,ypos-0.31*fact,ypos-0.33*fact,ypos-0.35*fact),col="brown",lwd=2*fact)
  polygon(x=c(xpos+0.1*fact,xpos+0.11*fact,xpos+0.16*fact),y=c(ypos-0.38*fact,ypos-0.32*fact,ypos-0.26*fact),col="grey95",lwd=2*fact)
  points(x=c(xpos+0.1*fact,xpos+0.155*fact),y=c(ypos-0.38*fact,ypos-0.27*fact),col="black",pch=21,bg="blue",lwd=2*fact,cex=2*fact)
}
#######################################################################################
#######################################################################################

rect(xleft=0.1,xright=0.9,ybottom=0.4,ytop=0.1,col="white",border=NA)
MapMaze(xpos=0.5,ypos=0.32,fact=0.7)
text(x=0.5,y=0.2,"The map will help you navigate!",cex=1.5)
rect(xleft=0.11,xright=0.33,ybottom=0.01,ytop=0.04,col="dodgerblue2",border=NA)

#Draw Wall Blocks Line by Line#
###############################
DrawWall.L1<-function(view){
if (any(view[1,c(4:6)]==78)){text(y=sample(seq(0.75,1.1,by=0.01),30,replace=T),x=sample(seq(0.3,0.7,by=0.01),30,replace=T),"*",cex=1,col="grey10")}
if (view[1,1]>20 & view[1,1]<24){AttackerSleep(xpos=-0.04,ypos=0.88,fact=0.2,level=view[1,1],eyes="closed",mouth=1)}
if (view[1,1]==87) {Tree(xpos=0,ypos=0.97,fact=0.4)}
if (view[1,1]==88) {FrontWall(xpos=-0.165,ypos=0.75,fact=0.15);polygon(x=c(-0.015,0.15,0.15,-0.015),y=c(0.75,0.8,2,2),lwd=2,col="grey80")}
if (view[1,1]==89) {FrontWall(xpos=-0.165,ypos=0.75,fact=0.15,col="darkgoldenrod3");polygon(x=c(-0.015,0.15,0.15,-0.015),y=c(0.75,0.8,2,2),lwd=2,col="darkgoldenrod4")}
if (view[1,1]==99) {FrontWall(xpos=-0.165,ypos=0.75,fact=0.15);polygon(x=c(-0.015,0.15,0.15,-0.015),y=c(0.75,0.8,2,2),lwd=2,col="grey80")
                    polygon(x=c(0.04,0.04,0.11,0.11),y=c(0.77,1,0.995,0.79),col="darkgoldenrod",lwd=2)
                    points(x=0.054,y=0.87,pch=19,cex=0.5)
                    }
if (view[1,9]>20 & view[1,9]<24){AttackerSleep(xpos=1.04,ypos=0.88,fact=0.2,level=view[1,9],eyes="closed",mouth=1)}
if (view[1,9]==87) {Tree(xpos=1,ypos=0.97,fact=0.4)}
if (view[1,9]==88) {FrontWall(xpos=1.015,ypos=0.75,fact=0.15);polygon(x=c(1.015,0.85,0.85,1.015),y=c(0.75,0.8,2,2),lwd=2,col="grey80")}
if (view[1,9]==89) {FrontWall(xpos=1.015,ypos=0.75,fact=0.15,col="darkgoldenrod3");polygon(x=c(1.015,0.85,0.85,1.015),y=c(0.75,0.8,2,2),lwd=2,col="darkgoldenrod4")}
if (view[1,9]==99) {FrontWall(xpos=1.015,ypos=0.75,fact=0.15);polygon(x=c(1.015,0.85,0.85,1.015),y=c(0.75,0.8,2,2),lwd=2,col="grey80")
                    polygon(x=c(0.96,0.96,0.89,0.89),y=c(0.77,1,0.995,0.79),col="darkgoldenrod",lwd=2)
                    points(x=0.9,y=0.87,pch=19,cex=0.5)
                    }
if (view[1,2]>20 & view[1,2]<24){AttackerSleep(xpos=0.1,ypos=0.88,fact=0.2,level=view[1,2],eyes="closed",mouth=1)}
if (view[1,2]==87) {Tree(xpos=0.1,ypos=0.95,fact=0.4)}
if (view[1,2]==88) {FrontWall(xpos=-0.015,ypos=0.75,fact=0.15);polygon(x=c(0.135,0.25,0.25,0.135),y=c(0.75,0.8,2,2),lwd=2,col="grey80")}
if (view[1,2]==89) {FrontWall(xpos=-0.015,ypos=0.75,fact=0.15,col="darkgoldenrod3");polygon(x=c(0.135,0.25,0.25,0.135),y=c(0.75,0.8,2,2),lwd=2,col="darkgoldenrod4")}
if (view[1,2]==99) {FrontWall(xpos=-0.015,ypos=0.75,fact=0.15);polygon(x=c(0.135,0.25,0.25,0.135),y=c(0.75,0.8,2,2),lwd=2,col="grey80")
                    polygon(x=c(0.16,0.16,0.23,0.23),y=c(0.76,1,0.995,0.792),col="darkgoldenrod",lwd=2)
                    points(x=0.17,y=0.87,pch=19,cex=0.5)
                    polygon(x=c(0.01,0.01,0.1,0.1),y=c(0.753,1,1,0.753),col="darkgoldenrod",lwd=2)
                    points(x=0.02,y=0.87,pch=19,cex=0.5)
                    }
if (view[1,8]>20 & view[1,8]<24){AttackerSleep(xpos=0.9,ypos=0.88,fact=0.2,level=view[1,8],eyes="closed",mouth=1)}
if (view[1,8]==87) {Tree(xpos=0.9,ypos=0.95,fact=0.4)}
if (view[1,8]==88) {FrontWall(xpos=0.865,ypos=0.75,fact=0.15);polygon(x=c(0.865,0.75,0.75,0.865),y=c(0.75,0.8,2,2),lwd=2,col="grey80")}
if (view[1,8]==89) {FrontWall(xpos=0.865,ypos=0.75,fact=0.15,col="darkgoldenrod3");polygon(x=c(0.865,0.75,0.75,0.865),y=c(0.75,0.8,2,2),lwd=2,col="darkgoldenrod4")}
if (view[1,8]==99) {FrontWall(xpos=0.865,ypos=0.75,fact=0.15);polygon(x=c(0.865,0.75,0.75,0.865),y=c(0.75,0.8,2,2),lwd=2,col="grey80")
                    polygon(x=c(0.84,0.84,0.77,0.77),y=c(0.76,1,0.995,0.792),col="darkgoldenrod",lwd=2)
                    points(x=0.78,y=0.88,pch=19,cex=0.5)
                    polygon(x=c(0.99,0.99,0.9,0.9),y=c(0.753,1,1,0.753),col="darkgoldenrod",lwd=2)
                    points(x=0.98,y=0.87,pch=19,cex=0.5)
                    }
if (view[1,3]>20 & view[1,3]<24){AttackerSleep(xpos=0.24,ypos=0.88,fact=0.2,level=view[1,3],eyes="closed",mouth=1)}
if (view[1,3]==87) {Tree(xpos=0.25,ypos=0.96,fact=0.4)}
if (view[1,3]==88) {FrontWall(xpos=0.125,ypos=0.75,fact=0.15);polygon(x=c(0.275,0.35,0.35,0.275),y=c(0.75,0.8,2,2),lwd=2,col="grey80")}
if (view[1,3]==89) {FrontWall(xpos=0.125,ypos=0.75,fact=0.15,col="darkgoldenrod3");polygon(x=c(0.275,0.35,0.35,0.275),y=c(0.75,0.8,2,2),lwd=2,col="darkgoldenrod4")}
if (view[1,3]==99) {FrontWall(xpos=0.125,ypos=0.75,fact=0.15);polygon(x=c(0.275,0.35,0.35,0.275),y=c(0.75,0.8,2,2),lwd=2,col="grey80")
                    polygon(x=c(0.29,0.29,0.34,0.34),y=c(0.765,1,0.995,0.798),col="darkgoldenrod",lwd=2)
                    points(x=0.30,y=0.88,pch=19,cex=0.5)
                    polygon(x=c(0.15,0.15,0.24,0.24),y=c(0.753,1,1,0.753),col="darkgoldenrod",lwd=2)
                    points(x=0.16,y=0.87,pch=19,cex=0.5)
                    }
if (view[1,7]>20 & view[1,7]<24){AttackerSleep(xpos=0.76,ypos=0.88,fact=0.2,level=view[1,7],eyes="closed",mouth=1)}
if (view[1,7]==87) {Tree(xpos=0.75,ypos=0.96,fact=0.4)}
if (view[1,7]==88) {FrontWall(xpos=0.725,ypos=0.75,fact=0.15);polygon(x=c(0.725,0.65,0.65,0.725),y=c(0.75,0.8,2,2),lwd=2,col="grey80")}
if (view[1,7]==89) {FrontWall(xpos=0.725,ypos=0.75,fact=0.15,col="darkgoldenrod3");polygon(x=c(0.725,0.65,0.65,0.725),y=c(0.75,0.8,2,2),lwd=2,col="darkgoldenrod4")}
if (view[1,7]==99) {FrontWall(xpos=0.725,ypos=0.75,fact=0.15);polygon(x=c(0.725,0.65,0.65,0.725),y=c(0.75,0.8,2,2),lwd=2,col="grey80")
                    polygon(x=c(0.71,0.71,0.66,0.66),y=c(0.765,1,0.995,0.798),col="darkgoldenrod",lwd=2)
                    points(x=0.67,y=0.88,pch=19,cex=0.5)
                    polygon(x=c(0.85,0.85,0.76,0.76),y=c(0.753,1,1,0.753),col="darkgoldenrod",lwd=2)
                    points(x=0.77,y=0.87,pch=19,cex=0.5)
                    }
if (view[1,4]>20 & view[1,4]<24){AttackerSleep(xpos=0.38,ypos=0.88,fact=0.2,level=view[1,4],eyes="closed",mouth=1)}
if (view[1,4]==87) {Tree(xpos=0.36,ypos=0.95,fact=0.4)}
if (view[1,4]==88) {FrontWall(xpos=0.275,ypos=0.75,fact=0.15);polygon(x=c(0.425,0.45,0.45,0.425),y=c(0.75,0.8,2,2),lwd=2,col="grey80")}
if (view[1,4]==89) {FrontWall(xpos=0.275,ypos=0.75,fact=0.15,col="darkgoldenrod3");polygon(x=c(0.425,0.45,0.45,0.425),y=c(0.75,0.8,2,2),lwd=2,col="darkgoldenrod4")}
if (view[1,4]==99) {FrontWall(xpos=0.275,ypos=0.75,fact=0.15);polygon(x=c(0.425,0.45,0.45,0.425),y=c(0.75,0.8,2,2),lwd=2,col="grey80")
                    polygon(x=c(0.43,0.43,0.445,0.445),y=c(0.765,1,0.995,0.788),col="darkgoldenrod",lwd=2)
                    points(x=0.435,y=0.88,pch=19,cex=0.5)
                    polygon(x=c(0.3,0.3,0.39,0.39),y=c(0.753,1,1,0.753),col="darkgoldenrod",lwd=2)
                    points(x=0.31,y=0.87,pch=19,cex=0.5)
                    }
if (view[1,6]>20 & view[1,6]<24){AttackerSleep(xpos=0.62,ypos=0.88,fact=0.2,level=view[1,6],eyes="closed",mouth=1)}
if (view[1,6]==87) {Tree(xpos=0.64,ypos=0.95,fact=0.4)}
if (view[1,6]==88) {FrontWall(xpos=0.575,ypos=0.75,fact=0.15);polygon(x=c(0.575,0.55,0.55,0.575),y=c(0.75,0.8,2,2),lwd=2,col="grey80")}
if (view[1,6]==89) {FrontWall(xpos=0.575,ypos=0.75,fact=0.15,col="darkgoldenrod3");polygon(x=c(0.575,0.55,0.55,0.575),y=c(0.75,0.8,2,2),lwd=2,col="darkgoldenrod4")}
if (view[1,6]==99) {FrontWall(xpos=0.575,ypos=0.75,fact=0.15);polygon(x=c(0.575,0.55,0.55,0.575),y=c(0.75,0.8,2,2),lwd=2,col="grey80")
                    polygon(x=c(0.57,0.57,0.555,0.555),y=c(0.765,1,0.995,0.788),col="darkgoldenrod",lwd=2)
                    points(x=0.56,y=0.88,pch=19,cex=0.5)
                    polygon(x=c(0.7,0.7,0.61,0.61),y=c(0.753,1,1,0.753),col="darkgoldenrod",lwd=2)
                    points(x=0.62,y=0.87,pch=19,cex=0.5)
                    }
if (view[1,5]>20 & view[1,5]<24){AttackerSleep(xpos=0.5,ypos=0.88,fact=0.2,level=view[1,5],eyes="closed",mouth=1)}
if (view[1,5]==87) {Tree(xpos=0.5,ypos=0.94,fact=0.4)}
if (view[1,5]==88) {FrontWall(xpos=0.425,ypos=0.75,fact=0.15)}
if (view[1,5]==89) {FrontWall(xpos=0.425,ypos=0.75,fact=0.15,col="darkgoldenrod3")}
if (view[1,5]==99) {FrontWall(xpos=0.425,ypos=0.75,fact=0.15)
                    polygon(x=c(0.45,0.45,0.55,0.55),y=c(0.753,1,1,0.753),col="darkgoldenrod",lwd=2)
                    points(x=0.46,y=0.87,pch=19,cex=0.5)
                    }
} #With/Without Doors and Trees and Attacker
DrawWall.L2<-function(view){
if (any(view[2,c(4:6)]==78)){text(y=sample(seq(0.65,1.1,by=0.01),15,replace=T),x=sample(seq(0.3,0.7,by=0.01),15,replace=T),"*",cex=sample(seq(1,3,by=0.1),15,replace=T),col="grey20")}
if (view[2,1]==88) {polygon(x=c(-0.05,-0.01,-0.01,-0.05),y=c(0.74,0.75,2,2),lwd=2,col="grey80")}
if (view[2,1]==89) {polygon(x=c(-0.05,-0.01,-0.01,-0.05),y=c(0.74,0.75,2,2),lwd=2,col="darkgoldenrod4")}

if (view[2,9]==88) {polygon(x=c(1.05,1.01,1.01,1.05),y=c(0.74,0.75,2,2),lwd=2,col="grey80")}
if (view[2,9]==89) {polygon(x=c(1.05,1.01,1.01,1.05),y=c(0.74,0.75,2,2),lwd=2,col="darkgoldenrod4")}

if (view[2,2]>20 & view[2,2]<24){AttackerSleep(xpos=0,ypos=0.8,fact=0.3,level=view[2,2],eyes="closed",mouth=1)}
if (view[2,2]==87) {Tree(xpos=-0.03,ypos=0.98,fact=0.6)}
if (view[2,2]==88) {polygon(x=c(-0.07,0.14,0.14,-0.07),y=c(0.65,0.75,2,2),lwd=2,col="grey80")}
if (view[2,2]==89) {polygon(x=c(-0.07,0.14,0.14,-0.07),y=c(0.65,0.75,2,2),lwd=2,col="darkgoldenrod4")}
if (view[2,2]==99) {polygon(x=c(-0.07,0.14,0.14,-0.07),y=c(0.65,0.75,2,2),lwd=2,col="grey80")
                    polygon(x=c(0,0.1,0.1,0),y=c(0.68,0.73,1,1.01),col="darkgoldenrod",lwd=2)
                    points(x=0.02,y=0.84,pch=19,cex=1)
                    }
if (view[2,8]>20 & view[2,8]<24){AttackerSleep(xpos=1,ypos=0.8,fact=0.3,level=view[2,8],eyes="closed",mouth=1)}
if (view[2,8]==87) {Tree(xpos=1.03,ypos=0.98,fact=0.6)}
if (view[2,8]==88) {polygon(x=c(1.07,0.86,0.86,1.07),y=c(0.65,0.75,2,2),lwd=2,col="grey80")}
if (view[2,8]==89) {polygon(x=c(1.07,0.86,0.86,1.07),y=c(0.65,0.75,2,2),lwd=2,col="darkgoldenrod4")}
if (view[2,8]==99) {polygon(x=c(1.07,0.86,0.86,1.07),y=c(0.65,0.75,2,2),lwd=2,col="grey80")
                    polygon(x=c(1,0.9,0.9,1),y=c(0.68,0.73,1,1.01),col="darkgoldenrod",lwd=2)
                    points(x=0.91,y=0.87,pch=19,cex=1)
                    }
if (view[2,3]>20 & view[2,3]<24){AttackerSleep(xpos=0.1,ypos=0.8,fact=0.3,level=view[2,3],eyes="closed",mouth=1)}
if (view[2,3]==87) {Tree(xpos=0.13,ypos=0.97,fact=0.6)}
if (view[2,3]==88) {FrontWall(xpos=-0.1,ypos=0.65,fact=0.24);polygon(x=c(0.14,0.28,0.28,0.14),y=c(0.65,0.75,2,2),lwd=2,col="grey80")}
if (view[2,3]==89) {FrontWall(xpos=-0.1,ypos=0.65,fact=0.24,col="darkgoldenrod3");polygon(x=c(0.14,0.28,0.28,0.14),y=c(0.65,0.75,2,2),lwd=2,col="darkgoldenrod4")}
if (view[2,3]==99) {FrontWall(xpos=-0.1,ypos=0.65,fact=0.24);polygon(x=c(0.14,0.28,0.28,0.14),y=c(0.65,0.75,2,2),lwd=2,col="grey80")
                    polygon(x=c(0.18,0.26,0.26,0.18),y=c(0.68,0.735,1,1.01),col="darkgoldenrod",lwd=2)
                    points(x=0.19,y=0.85,pch=19,cex=1)
                    polygon(x=c(-0.03,0.1,0.1,-0.03),y=c(0.65,0.65,1,1),col="darkgoldenrod",lwd=2)
                    points(x=-0.02,y=0.83,pch=19,cex=1)
                    }
if (view[2,7]>20 & view[2,7]<24){AttackerSleep(xpos=0.9,ypos=0.8,fact=0.3,level=view[2,7],eyes="closed",mouth=1)}
if (view[2,7]==87) {Tree(xpos=0.87,ypos=0.97,fact=0.6)}
if (view[2,7]==88) {FrontWall(xpos=0.86,ypos=0.65,fact=0.24);polygon(x=c(0.86,0.72,0.72,0.86),y=c(0.65,0.75,2,2),lwd=2,col="grey80")}
if (view[2,7]==89) {FrontWall(xpos=0.86,ypos=0.65,fact=0.24,col="darkgoldenrod3");polygon(x=c(0.86,0.72,0.72,0.86),y=c(0.65,0.75,2,2),lwd=2,col="darkgoldenrod4")}
if (view[2,7]==99) {FrontWall(xpos=0.86,ypos=0.65,fact=0.24);polygon(x=c(0.86,0.72,0.72,0.86),y=c(0.65,0.75,2,2),lwd=2,col="grey80")
                    polygon(x=c(0.82,0.74,0.74,0.82),y=c(0.68,0.735,1,1.01),col="darkgoldenrod",lwd=2)
                    points(x=0.75,y=0.85,pch=19,cex=1)
                    polygon(x=c(1.03,0.9,0.9,1.03),y=c(0.65,0.65,1,1),col="darkgoldenrod",lwd=2)
                    points(x=0.91,y=0.83,pch=19,cex=1)
                    }
if (view[2,4]>20 & view[2,4]<24){AttackerSleep(xpos=0.31,ypos=0.8,fact=0.3,level=view[2,4],eyes="closed",mouth=1)}
if (view[2,4]==87) {Tree(xpos=0.28,ypos=0.96,fact=0.6)}
if (view[2,4]==88) {FrontWall(xpos=0.14,ypos=0.65,fact=0.24);polygon(x=c(0.38,0.425,0.425,0.38),y=c(0.65,0.75,2,2),lwd=2,col="grey80")}
if (view[2,4]==89) {FrontWall(xpos=0.14,ypos=0.65,fact=0.24,col="darkgoldenrod3");polygon(x=c(0.38,0.425,0.425,0.38),y=c(0.65,0.75,2,2),lwd=2,col="darkgoldenrod4")}
if (view[2,4]==99) {FrontWall(xpos=0.14,ypos=0.65,fact=0.24);polygon(x=c(0.38,0.425,0.425,0.38),y=c(0.65,0.75,2,2),lwd=2,col="grey80")
                    polygon(x=c(0.39,0.41,0.41,0.39),y=c(0.67,0.73,1,1.01),col="darkgoldenrod",lwd=2)
                    points(x=0.395,y=0.85,pch=19,cex=0.5)
                    polygon(x=c(0.19,0.33,0.33,0.19),y=c(0.65,0.65,1,1),col="darkgoldenrod",lwd=2)
                    points(x=0.20,y=0.83,pch=19,cex=1)
                    }
if (view[2,6]>20 & view[2,6]<24){AttackerSleep(xpos=0.69,ypos=0.8,fact=0.3,level=view[2,6],eyes="closed",mouth=1)}
if (view[2,6]==87) {Tree(xpos=0.72,ypos=0.96,fact=0.6)}
if (view[2,6]==88) {FrontWall(xpos=0.62,ypos=0.65,fact=0.24);polygon(x=c(0.62,0.575,0.575,0.62),y=c(0.65,0.75,2,2),lwd=2,col="grey80")}
if (view[2,6]==89) {FrontWall(xpos=0.62,ypos=0.65,fact=0.24,col="darkgoldenrod3");polygon(x=c(0.62,0.575,0.575,0.62),y=c(0.65,0.75,2,2),lwd=2,col="darkgoldenrod4")}
if (view[2,6]==99) {FrontWall(xpos=0.62,ypos=0.65,fact=0.24);polygon(x=c(0.62,0.575,0.575,0.62),y=c(0.65,0.75,2,2),lwd=2,col="grey80")
                    polygon(x=c(0.61,0.59,0.59,0.61),y=c(0.67,0.73,1,1.01),col="darkgoldenrod",lwd=2)
                    points(x=0.595,y=0.85,pch=19,cex=0.5)
                    polygon(x=c(0.81,0.67,0.67,0.81),y=c(0.65,0.65,1,1),col="darkgoldenrod",lwd=2)
                    points(x=0.68,y=0.83,pch=19,cex=1)
                    }
if (view[2,5]>20 & view[2,5]<24){AttackerSleep(xpos=0.5,ypos=0.8,fact=0.3,level=view[2,5],eyes="closed",mouth=1)}
if (view[2,5]==87) {Tree(xpos=0.5,ypos=0.95,fact=0.6)}
if (view[2,5]==88) {FrontWall(xpos=0.38,ypos=0.65,fact=0.24)}
if (view[2,5]==89) {FrontWall(xpos=0.38,ypos=0.65,fact=0.24,col="darkgoldenrod3")}
if (view[2,5]==99) {FrontWall(xpos=0.38,ypos=0.65,fact=0.24)
                    polygon(x=c(0.42,0.58,0.58,0.42),y=c(0.65,0.65,1,1),col="darkgoldenrod",lwd=2)
                    points(x=0.43,y=0.83,pch=19,cex=1)
                    }
} #With/Without Doors and Trees and Attacker
DrawWall.L3<-function(view){
if (any(view[3,c(4:6)]==78)){text(y=sample(seq(0.45,1.1,by=0.01),15,replace=T),x=sample(seq(0.3,0.7,by=0.01),15,replace=T),"*",cex=sample(seq(3,4,by=0.1),15,replace=T),col="grey30")}
if (view[3,3]>20 & view[3,3]<24){AttackerSleep(xpos=0.0,ypos=0.67,fact=0.4,level=view[3,3],eyes="closed",mouth=1)}
if (view[3,3]==87) {Tree(xpos=-0.05,ypos=1.05,fact=1)}
if (view[3,3]==88) {polygon(x=c(-0.15,0.14,0.14,-0.15),y=c(0.45,0.65,2,2),lwd=2,col="grey80")}
if (view[3,3]==89) {polygon(x=c(-0.15,0.14,0.14,-0.15),y=c(0.45,0.65,2,2),lwd=2,col="darkgoldenrod4")}
if (view[3,3]==99) {polygon(x=c(-0.15,0.14,0.14,-0.15),y=c(0.45,0.65,2,2),lwd=2,col="grey80")
                    polygon(x=c(0,0.1,0.1,0),y=c(0.55,0.625,1,1.05),col="darkgoldenrod",lwd=2)
                    points(x=0.01,y=0.8,pch=19,cex=1)
                    }
if (view[3,7]>20 & view[3,7]<24){AttackerSleep(xpos=1,ypos=0.67,fact=0.4,level=view[3,7],eyes="closed",mouth=1)}
if (view[3,7]==87) {Tree(xpos=1.05,ypos=1.05,fact=1)}
if (view[3,7]==88) {polygon(x=c(1.15,0.86,0.86,1.15),y=c(0.45,0.65,2,2),lwd=2,col="grey80")}
if (view[3,7]==89) {polygon(x=c(1.15,0.86,0.86,1.15),y=c(0.45,0.65,2,2),lwd=2,col="darkgoldenrod4")}
if (view[3,7]==99) {polygon(x=c(1.15,0.86,0.86,1.15),y=c(0.45,0.65,2,2),lwd=2,col="grey80")
                    polygon(x=c(1,0.9,0.9,1),y=c(0.55,0.625,1,1.05),col="darkgoldenrod",lwd=2)
                    points(x=0.91,y=0.79,pch=19,cex=1)
                    }
if (view[3,4]>20 & view[3,4]<24){AttackerSleep(xpos=0.21,ypos=0.67,fact=0.4,level=view[3,4],eyes="closed",mouth=1)}
if (view[3,4]==87) {Tree(xpos=0.15,ypos=1,fact=1)}
if (view[3,4]==88) {FrontWall(xpos=-0.145,ypos=0.45,fact=0.435);polygon(x=c(0.29,0.38,0.38,0.29),y=c(0.45,0.65,2,2),lwd=2,col="grey80")}
if (view[3,4]==89) {FrontWall(xpos=-0.145,ypos=0.45,fact=0.435,col="darkgoldenrod3");polygon(x=c(0.29,0.38,0.38,0.29),y=c(0.45,0.65,2,2),lwd=2,col="darkgoldenrod4")}
if (view[3,4]==99) {FrontWall(xpos=-0.145,ypos=0.45,fact=0.435);polygon(x=c(0.29,0.38,0.38,0.29),y=c(0.45,0.65,2,2),lwd=2,col="grey80")
                    polygon(x=c(0.31,0.37,0.37,0.31),y=c(0.5,0.63,1,1.02),col="darkgoldenrod",lwd=2)
                    points(x=0.32,y=0.78,pch=19,cex=1)
                    polygon(x=c(-0.01,0.23,0.23,-0.01),y=c(0.45,0.45,1.02,1.02),col="darkgoldenrod",lwd=2)
                    points(x=0,y=0.72,pch=19,cex=1)
                    }
if (view[3,6]>20 & view[3,6]<24){AttackerSleep(xpos=0.79,ypos=0.67,fact=0.4,level=view[3,6],eyes="closed",mouth=1)}
if (view[3,6]==87) {Tree(xpos=0.85,ypos=1,fact=1)}
if (view[3,6]==88) {FrontWall(xpos=0.71,ypos=0.45,fact=0.435);polygon(x=c(0.71,0.62,0.62,0.71),y=c(0.45,0.65,2,2),lwd=2,col="grey80")}
if (view[3,6]==89) {FrontWall(xpos=0.71,ypos=0.45,fact=0.435,col="darkgoldenrod3");polygon(x=c(0.71,0.62,0.62,0.71),y=c(0.45,0.65,2,2),lwd=2,col="darkgoldenrod4")}
if (view[3,6]==99) {FrontWall(xpos=0.71,ypos=0.45,fact=0.435);polygon(x=c(0.71,0.62,0.62,0.71),y=c(0.45,0.65,2,2),lwd=2,col="grey80")
                    polygon(x=c(0.69,0.63,0.63,0.69),y=c(0.5,0.63,1,1.02),col="darkgoldenrod",lwd=2)
                    points(x=0.64,y=0.78,pch=19,cex=1)
                    polygon(x=c(1.01,0.77,0.77,1.01),y=c(0.45,0.45,1.02,1.02),col="darkgoldenrod",lwd=2)
                    points(x=0.78,y=0.72,pch=19,cex=1)
                    }
if (view[3,5]>20 & view[3,5]<24){AttackerSleep(xpos=0.5,ypos=0.67,fact=0.4,level=view[3,5],eyes="closed",mouth=1)}
if (view[3,5]==87) {Tree(xpos=0.53,ypos=0.95,fact=1)}
if (view[3,5]==88) {FrontWall(xpos=0.285,ypos=0.45,fact=0.435)}
if (view[3,5]==89) {FrontWall(xpos=0.285,ypos=0.45,fact=0.435,col="darkgoldenrod3")}
if (view[3,5]==99) {FrontWall(xpos=0.285,ypos=0.45,fact=0.435)
                    polygon(x=c(0.36,0.64,0.64,0.36),y=c(0.45,0.45,1.02,1.02),col="darkgoldenrod",lwd=2)
                    points(x=0.38,y=0.72,pch=19,cex=1)
                   }
} #With/Without Doors and Trees and Attacker
DrawWall.L4<-function(view){
if (any(view[4,c(4:6)]==78)){text(y=sample(seq(0.05,1.1,by=0.01),15,replace=T),x=sample(seq(0.3,0.7,by=0.01),15,replace=T),"*",cex=sample(seq(4,5,by=0.1),15,replace=T),col="grey70")}
if (view[4,4]==87) {Tree(xpos=-0.05,ypos=0.7,fact=1.2)}
if (view[4,4]==88) {FrontWall(xpos=-0.7,ypos=0.05,fact=0.8);polygon(x=c(0.1,0.29,0.29,0.1),y=c(0.05,0.45,2,2),lwd=2,col="grey80")}
if (view[4,4]==89) {FrontWall(xpos=-0.7,ypos=0.05,fact=0.8,col="darkgoldenrod3");polygon(x=c(0.1,0.29,0.29,0.1),y=c(0.05,0.45,2,2),lwd=2,col="darkgoldenrod4")}
if (view[4,4]==99) {FrontWall(xpos=-0.7,ypos=0.05,fact=0.8);polygon(x=c(0.1,0.29,0.29,0.1),y=c(0.05,0.45,2,2),lwd=2,col="grey80")
                    polygon(x=c(-0.1,0.01,0.01,-0.1),y=c(0.05,0.05,1,1),col="darkgoldenrod",lwd=2)
                    polygon(x=c(0.16,0.26,0.26,0.16),y=c(0.17,0.39,1,1.05),col="darkgoldenrod",lwd=2)
                    points(x=0.18,y=0.62,pch=19,cex=1)
                    }
if (view[4,6]==87) {Tree(xpos=1.05,ypos=0.7,fact=1.2)}
if (view[4,6]==88) {FrontWall(xpos=0.9,ypos=0.05,fact=0.8);polygon(x=c(0.9,0.71,0.71,0.9),y=c(0.05,0.45,2,2),lwd=2,col="grey80")}
if (view[4,6]==89) {FrontWall(xpos=0.9,ypos=0.05,fact=0.8,col="darkgoldenrod3");polygon(x=c(0.9,0.71,0.71,0.9),y=c(0.05,0.45,2,2),lwd=2,col="darkgoldenrod4")}
if (view[4,6]==99) {FrontWall(xpos=0.9,ypos=0.05,fact=0.8);polygon(x=c(0.9,0.71,0.71,0.9),y=c(0.05,0.45,2,2),lwd=2,col="grey80")
                    polygon(x=c(1.1,0.99,0.99,1.1),y=c(0.05,0.05,1,1),col="darkgoldenrod",lwd=2)
                    polygon(x=c(0.84,0.74,0.74,0.84),y=c(0.17,0.39,1,1.05),col="darkgoldenrod",lwd=2)
                    points(x=0.75,y=0.62,pch=19,cex=1)
                    }
if (view[4,5]==87) {Tree(xpos=0.5,ypos=0.65,fact=1.2)}
if (view[4,5]==88) {FrontWall(xpos=0.1,ypos=0.05,fact=0.8)}
if (view[4,5]==89) {FrontWall(xpos=0.1,ypos=0.05,fact=0.8,col="darkgoldenrod3")}
if (view[4,5]==99) {FrontWall(xpos=0.1,ypos=0.05,fact=0.8)
                    polygon(x=c(0.28,0.28,0.72,0.72),y=c(0.05,1,1,0.05),col="darkgoldenrod",lwd=3)
                    points(x=0.33,y=0.516,pch=19,cex=2)                 
                    }
} #With/Without Doors and Trees
DrawWall.L5<-function(view){
if (view[5,4]==88) {polygon(x=c(-0.1,0.1,0.1,0),y=c(-0.38,0.05,2,2),lwd=2,col="grey80")}
if (view[5,4]==89) {polygon(x=c(-0.1,0.1,0.1,0),y=c(-0.38,0.05,2,2),lwd=2,col="darkgoldenrod4")}
if (view[5,4]==99) {polygon(x=c(-0.1,0.1,0.1,0),y=c(-0.38,0.05,2,2),lwd=2,col="grey80")
                    polygon(x=c(-0.1,0.08,0.08,-0.1),y=c(-0.38,0.01,1,1.02),col="darkgoldenrod",lwd=2)
                    }
if (view[5,6]==88) {polygon(x=c(1.1,0.9,0.9,1.1),y=c(-0.38,0.05,2,2),lwd=2,col="grey80")}
if (view[5,6]==89) {polygon(x=c(1.1,0.9,0.9,1.1),y=c(-0.38,0.05,2,2),lwd=2,col="darkgoldenrod4")}
if (view[5,6]==99) {polygon(x=c(1.1,0.9,0.9,1.1),y=c(-0.38,0.05,2,2),lwd=2,col="grey80")
                    polygon(x=c(1.1,0.92,0.92,1.1),y=c(-0.38,0.01,1,1.02),col="darkgoldenrod",lwd=2)
                    points(x=0.95,y=0.49,pch=19,cex=2)
}
} #With/Without Doors and Trees
#######################################################################################
#######################################################################################

rect(xleft=0.11,xright=0.45,ybottom=0.01,ytop=0.04,col="dodgerblue2",border=NA)

#Draw The Map Function#
#######################
DrawMap<-function(Map,Position){
  
  map.x<-matrix(sort(rep(c(length(Map[1,]):1),length(Map[,1])),decreasing=F)/max(length(Map[1,])),nrow=length(Map[,1]),byrow=F)
  map.y<-matrix(rep(c(length(Map[,1]):1),length(Map[1,]))/max(length(Map[,1])),nrow=length(Map[,1]),byrow=F)
  
  polygon(x=c(0.017,0.070,0.021,0.060,0.068,0.263,0.591,0.902,0.994,0.947,1.005,0.960,1.013,0.708,0.546,0.287,0.130), y=c(0.981,0.700,0.448,0.155,0.014,0.051,-0.009,0.061,0.132,0.308,0.535,0.782,0.985,1.018,0.988,1.018,1.0234),lwd=3,xpd=T,col="lightgoldenrod2")
  
  points(map.y~map.x,col=Map/Map,pch=15,cex=48/max(length(Map[1,]),length(Map[,1]))+0.5,xlim=c(1,length(Map[1,])),ylim=c(1,length(Map[,1])),asp=1)
  points(map.y[which(Position==1)]~map.x[which(Position==1)],pch=25,bg="white",lwd=1,cex=24/max(length(Map[1,]),length(Map[,1])),col="white")
  
  locator(1)
}
#######################################################################################
#######################################################################################

rect(xleft=-1,xright=2,ybottom=0.4,ytop=0.1,col="white",border=NA)
Medikit(xpos=0.35,ypos=0.33,fact=0.5)
Sword(xpos=0.60,ypos=0.48,fact=0.5)
text(x=0.5,y=0.2,"Stay healthy and get stronger!",cex=1.5)
rect(xleft=0.11,xright=0.47,ybottom=0.01,ytop=0.04,col="dodgerblue2",border=NA)

#Draw Wood - Object 4#
######################
Wood<-function(xpos=0.5,ypos=0.3,fact=1){
  
  polygon(x=c(xpos-0.2*fact,xpos+0.2*fact,xpos+0.25*fact,xpos-0.15*fact),y=c(ypos-0.17*fact,ypos-0.17*fact,ypos-0.07*fact,ypos-0.07*fact),lwd=2*fact,col="darkorange4")
  polygon(x=c(xpos-0.2*fact,xpos+0.2*fact,xpos+0.25*fact,xpos-0.15*fact),y=c(ypos-0.16*fact,ypos-0.16*fact,ypos-0.06*fact,ypos-0.06*fact),lwd=2*fact,col="darkorange4")
  polygon(x=c(xpos-0.2*fact,xpos+0.2*fact,xpos+0.25*fact,xpos-0.15*fact),y=c(ypos-0.15*fact,ypos-0.15*fact,ypos-0.05*fact,ypos-0.05*fact),lwd=2*fact,col="darkorange4")
  
  points(x=rep(xpos-0.1*fact,5),y=rep(ypos-0.12*fact,5),cex=c(3,2.5,2,1.5,1,0.5)*fact)
  points(x=rep(xpos+0.05*fact,5),y=rep(ypos-0.09*fact,5),cex=c(3,2.5,2,1.5,1,0.5)*fact)
  points(x=rep(xpos+0.18*fact,5),y=rep(ypos-0.11*fact,5),cex=c(3,2.5,2,1.5,1,0.5)*fact)
}
#######################################################################################
#######################################################################################

#Draw Hammer - Object 5#
########################
Hammer<-function(xpos=0.5,ypos=0.3,fact=1){
  polygon(x=c(xpos-0.02*fact,xpos-0.02*fact,xpos+0.1*fact,xpos+0.1*fact),y=c(ypos-0.08*fact,ypos-0.06*fact,ypos-0.1*fact,ypos-0.12*fact),col="darkorange4")
  polygon(x=c(xpos-0.14*fact,xpos-0.1*fact,xpos,xpos-0.02*fact),y=c(ypos-0.07*fact,ypos,ypos-0.03*fact,ypos-0.12*fact),col="grey40")
  points(x=c(xpos-0.11*fact,xpos-0.07*fact,xpos-0.06*fact,xpos-0.02*fact,xpos-0.03*fact),y=c(ypos-0.06*fact,ypos-0.03*fact,ypos-0.08*fact,ypos-0.04*fact,ypos-0.1*fact),pch=17,col="grey10")
}
#######################################################################################
#######################################################################################

#Torch Draw - Object 8#
#######################
Torch<-function(xpos=0.5,ypos=0.5,fact=1){
  polygon(x=xpos+c(-0.28,0.01,0.07,-0.18)*fact,y=ypos+c(-0.15,0.04,0.02,-0.17)*fact,col="brown")
  polygon(x=xpos+c(0.05,0.09,0.12,0.14,0.16,0.20,0.21,0.20,0.18,0.12)*fact,y=ypos+c(0.06,0.11,0.19,0.25,0.19,0.24,0.17,0.10,0.06,0.03)*fact,col="orange")
  polygon(x=xpos+c(0.05,0.09,0.12,0.14,0.16,0.17,0.20,0.18,0.18,0.12)*fact,y=ypos+c(0.06,0.09,0.16,0.19,0.18,0.21,0.16,0.10,0.06,0.03)*fact,col="yellow")
  polygon(x=xpos+c(-0.08,0.02,0.13,0.03)*fact,y=ypos+c(0,-0.05,0.03,0.08)*fact,col="brown")
  polygon(x=xpos+c(-0.08,0.02,0.13,0.03)*fact,y=ypos+c(0,-0.05,0.03,0.08)*fact,col="black",density=20)
  polygon(x=xpos+c(-0.08,0.02,0.13,0.03)*fact,y=ypos+c(0,-0.05,0.03,0.08)*fact,col="black",density=10,angle=120)
  points(x=xpos+sample(seq(0,0.25,by=0.01),50,replace=T)*fact,y=ypos+sample(seq(0.1,0.3,by=0.01),50,replace=T)*fact,col="red",cex=0.5,pch=19)
  points(x=xpos+sample(seq(0,0.25,by=0.01),50,replace=T)*fact,y=ypos+sample(seq(0.1,0.3,by=0.01),50,replace=T)*fact,col="yellow",cex=0.5,pch=19)
}  
#######################################################################################
#######################################################################################

#Draw Hole(+Wood) - Object 31/32#
#################################
Hole<-function(xpos=0.5,ypos=0.3,fact=1,Wood=F){
  
  polygon(x=c(xpos-0.18*fact,xpos-0.32*fact,xpos-0.26*fact,xpos-0.06*fact,xpos+0.17*fact,xpos+0.32*fact,xpos+0.14*fact),y=c(ypos-0.02*fact,ypos-0.11*fact,ypos-0.19*fact,ypos-0.24*fact,ypos-0.22*fact,ypos-0.09*fact,ypos-0.02*fact),col="grey70")
  
  lines(x=c(xpos+0.17*fact,xpos+0.14*fact,xpos+0.15*fact),y=c(ypos,ypos-0.03*fact,ypos-0.12*fact),col="green",lwd=4)
  lines(x=c(xpos+0.18*fact,xpos+0.15*fact,xpos+0.16*fact),y=c(ypos,ypos-0.03*fact,ypos-0.12*fact),col="chartreuse4",lwd=4)
  lines(x=c(xpos+0.18*fact,xpos+0.14*fact,xpos+0.16*fact),y=c(ypos,ypos-0.03*fact,ypos-0.12*fact),col="darkgreen",lwd=4)
  
  lines(x=c(xpos-0.18*fact,xpos-0.15*fact,xpos-0.15*fact),y=c(ypos-0.04*fact,ypos-0.14*fact,ypos-0.21*fact),col="grey50",lwd=4)
  lines(x=c(xpos+0.11*fact,xpos+0.09*fact,xpos+0.08*fact),y=c(ypos-0.05*fact,ypos-0.11*fact,ypos-0.21*fact),col="grey50",lwd=4)
  
  if (Wood==T){
    polygon(x=c(xpos-0.06*fact,xpos+0.07*fact,xpos+0.03*fact,xpos-0.04*fact),y=c(ypos-0.28*fact,ypos-0.26*fact,ypos+0.01*fact,ypos),lwd=2+fact,col="darkorange4")
    points(x=rep(xpos,5),y=rep(ypos-0.22*fact,5),cex=c(3,2.5,2,1.5,1,0.5)*fact)
    points(x=rep(xpos+0.01*fact,5),y=rep(ypos-0.07*fact,5),cex=c(3,2.5,2,1.5,1,0.5)*fact)
  } 
}
#######################################################################################
#######################################################################################

#Medikit in View#
#################
MedikitDraw<-function(view){
  
  if (1 %in% view){
    
    #Line 1 Medikit
    if (view[1,1]==1) Medikit(xpos=0,ypos=0.78,fact=0.18)
    if (view[1,2]==1) Medikit(xpos=0.13,ypos=0.78,fact=0.18)
    if (view[1,3]==1) Medikit(xpos=0.26,ypos=0.78,fact=0.18)
    if (view[1,4]==1) Medikit(xpos=0.38,ypos=0.78,fact=0.18)
    if (view[1,5]==1) Medikit(xpos=0.5,ypos=0.78,fact=0.18)
    if (view[1,6]==1) Medikit(xpos=0.62,ypos=0.78,fact=0.18)
    if (view[1,7]==1) Medikit(xpos=0.74,ypos=0.78,fact=0.18)
    if (view[1,8]==1) Medikit(xpos=0.86,ypos=0.78,fact=0.18)
    if (view[1,9]==1) Medikit(xpos=1,ypos=0.78,fact=0.18)
    #Line 2 Medikit  
    if (view[2,2]==1) Medikit(xpos=0,ypos=0.72,fact=0.23)
    if (view[2,3]==1) Medikit(xpos=0.14,ypos=0.72,fact=0.23)
    if (view[2,4]==1) Medikit(xpos=0.32,ypos=0.72,fact=0.23)
    if (view[2,5]==1) Medikit(xpos=0.5,ypos=0.72,fact=0.23)
    if (view[2,6]==1) Medikit(xpos=0.68,ypos=0.72,fact=0.23)
    if (view[2,7]==1) Medikit(xpos=0.85,ypos=0.72,fact=0.23)
    if (view[2,8]==1) Medikit(xpos=1,ypos=0.72,fact=0.23)
    #Line 3 Medikit
    if (view[3,3]==1) Medikit(xpos=-0.03,ypos=0.6,fact=0.4)
    if (view[3,4]==1) Medikit(xpos=0.2,ypos=0.6,fact=0.4)
    if (view[3,5]==1) Medikit(xpos=0.5,ypos=0.6,fact=0.4)
    if (view[3,6]==1) Medikit(xpos=0.8,ypos=0.6,fact=0.4)
    if (view[3,7]==1) Medikit(xpos=1.03,ypos=0.6,fact=0.4)
    #Line 4 Medikit
    if (view[4,4]==1) Medikit(xpos=-0.05,ypos=0.3,fact=0.9)
    if (view[4,5]==1) Medikit(xpos=0.5,ypos=0.3,fact=0.9)
    if (view[4,6]==1) Medikit(xpos=1.05,ypos=0.3,fact=0.9)
  }
}
#######################################################################################
#######################################################################################

#Medikit in View#
#################
TorchDraw<-function(view){
  
  if (8 %in% view){
    
    #Line 1 Torch
    if (view[1,1]==8) Torch(xpos=0,ypos=0.78,fact=0.07)
    if (view[1,2]==8) Torch(xpos=0.13,ypos=0.78,fact=0.07)
    if (view[1,3]==8) Torch(xpos=0.26,ypos=0.78,fact=0.07)
    if (view[1,4]==8) Torch(xpos=0.38,ypos=0.78,fact=0.07)
    if (view[1,5]==8) Torch(xpos=0.5,ypos=0.78,fact=0.07)
    if (view[1,6]==8) Torch(xpos=0.62,ypos=0.78,fact=0.07)
    if (view[1,7]==8) Torch(xpos=0.74,ypos=0.78,fact=0.07)
    if (view[1,8]==8) Torch(xpos=0.86,ypos=0.78,fact=0.07)
    if (view[1,9]==8) Torch(xpos=1,ypos=0.78,fact=0.07)
    #Line 2 Torch  
    if (view[2,2]==8) Torch(xpos=0,ypos=0.72,fact=0.13)
    if (view[2,3]==8) Torch(xpos=0.12,ypos=0.7,fact=0.13)
    if (view[2,4]==8) Torch(xpos=0.32,ypos=0.7,fact=0.13)
    if (view[2,5]==8) Torch(xpos=0.5,ypos=0.7,fact=0.13)
    if (view[2,6]==8) Torch(xpos=0.68,ypos=0.7,fact=0.13)
    if (view[2,7]==8) Torch(xpos=0.87,ypos=0.7,fact=0.13)
    if (view[2,8]==8) Torch(xpos=1.05,ypos=0.72,fact=0.13)
    #Line 3 Torch
    if (view[3,3]==8) Torch(xpos=-0.05,ypos=0.55,fact=0.2)
    if (view[3,4]==8) Torch(xpos=0.2,ypos=0.55,fact=0.2)
    if (view[3,5]==8) Torch(xpos=0.5,ypos=0.55,fact=0.2)
    if (view[3,6]==8) Torch(xpos=0.8,ypos=0.55,fact=0.2)
    if (view[3,7]==8) Torch(xpos=1.10,ypos=0.55,fact=0.2)
    #Line 4 Torch
    if (view[4,4]==8) Torch(xpos=-0.05,ypos=0.3,fact=0.4)
    if (view[4,5]==8) Torch(xpos=0.5,ypos=0.3,fact=0.4)
    if (view[4,6]==8) Torch(xpos=1.05,ypos=0.3,fact=0.4)
  }
}
#######################################################################################
#######################################################################################

rect(xleft=0.11,xright=0.52,ybottom=0.01,ytop=0.04,col="dodgerblue2",border=NA)

#Key in View#
#############
KeyDraw<-function(view){
  
  if (2 %in% view){
    
    #Line 1 Key
    if (view[1,1]==2) Key(xpos=0,ypos=0.78,fact=0.18)
    if (view[1,2]==2) Key(xpos=0.13,ypos=0.78,fact=0.18)
    if (view[1,3]==2) Key(xpos=0.26,ypos=0.78,fact=0.18)
    if (view[1,4]==2) Key(xpos=0.38,ypos=0.78,fact=0.18)
    if (view[1,5]==2) Key(xpos=0.5,ypos=0.78,fact=0.18)
    if (view[1,6]==2) Key(xpos=0.62,ypos=0.78,fact=0.18)
    if (view[1,7]==2) Key(xpos=0.74,ypos=0.78,fact=0.18)
    if (view[1,8]==2) Key(xpos=0.86,ypos=0.78,fact=0.18)
    if (view[1,9]==2) Key(xpos=1,ypos=0.78,fact=0.18)
    #Line 2 Key  
    if (view[2,2]==2) Key(xpos=0,ypos=0.72,fact=0.23)
    if (view[2,3]==2) Key(xpos=0.14,ypos=0.72,fact=0.23)
    if (view[2,4]==2) Key(xpos=0.32,ypos=0.72,fact=0.23)
    if (view[2,5]==2) Key(xpos=0.5,ypos=0.72,fact=0.23)
    if (view[2,6]==2) Key(xpos=0.68,ypos=0.72,fact=0.23)
    if (view[2,7]==2) Key(xpos=0.85,ypos=0.72,fact=0.23)
    if (view[2,8]==2) Key(xpos=1,ypos=0.72,fact=0.23)
    #Line 3 Key
    if (view[3,3]==2) Key(xpos=-0.03,ypos=0.57,fact=0.4)
    if (view[3,4]==2) Key(xpos=0.2,ypos=0.57,fact=0.4)
    if (view[3,5]==2) Key(xpos=0.5,ypos=0.57,fact=0.4)
    if (view[3,6]==2) Key(xpos=0.8,ypos=0.57,fact=0.4)
    if (view[3,7]==2) Key(xpos=1.03,ypos=0.57,fact=0.4)
    #Line 4 Key
    if (view[4,4]==2) Key(xpos=0,ypos=0.3,fact=0.9)
    if (view[4,5]==2) Key(xpos=0.5,ypos=0.3,fact=0.9)
    if (view[4,6]==2) Key(xpos=1,ypos=0.3,fact=0.9)
  }
}
#######################################################################################
#######################################################################################

#Map in View#
#############
MapDraw<-function(view){
  
  if (3 %in% view){
    
    #Line 1 Map
    if (view[1,1]==3) MapMaze(xpos=-0.02,ypos=0.78,fact=0.17)
    if (view[1,2]==3) MapMaze(xpos=0.13,ypos=0.78,fact=0.17)
    if (view[1,3]==3) MapMaze(xpos=0.26,ypos=0.78,fact=0.17)
    if (view[1,4]==3) MapMaze(xpos=0.38,ypos=0.78,fact=0.17)
    if (view[1,5]==3) MapMaze(xpos=0.5,ypos=0.78,fact=0.17)
    if (view[1,6]==3) MapMaze(xpos=0.62,ypos=0.78,fact=0.17)
    if (view[1,7]==3) MapMaze(xpos=0.74,ypos=0.78,fact=0.17)
    if (view[1,8]==3) MapMaze(xpos=0.86,ypos=0.78,fact=0.17)
    if (view[1,9]==3) MapMaze(xpos=1.02,ypos=0.78,fact=0.17)
    #Line 2 Map  
    if (view[2,2]==3) MapMaze(xpos=-0.01,ypos=0.72,fact=0.20)
    if (view[2,3]==3) MapMaze(xpos=0.14,ypos=0.72,fact=0.20)
    if (view[2,4]==3) MapMaze(xpos=0.32,ypos=0.72,fact=0.20)
    if (view[2,5]==3) MapMaze(xpos=0.5,ypos=0.72,fact=0.20)
    if (view[2,6]==3) MapMaze(xpos=0.68,ypos=0.72,fact=0.20)
    if (view[2,7]==3) MapMaze(xpos=0.85,ypos=0.72,fact=0.20)
    if (view[2,8]==3) MapMaze(xpos=1.01,ypos=0.72,fact=0.20)
    #Line 3 Map
    if (view[3,3]==3) MapMaze(xpos=-0.03,ypos=0.6,fact=0.4)
    if (view[3,4]==3) MapMaze(xpos=0.2,ypos=0.6,fact=0.4)
    if (view[3,5]==3) MapMaze(xpos=0.5,ypos=0.6,fact=0.4)
    if (view[3,6]==3) MapMaze(xpos=0.8,ypos=0.6,fact=0.4)
    if (view[3,7]==3) MapMaze(xpos=1.03,ypos=0.6,fact=0.4)
    #Line 4 Map
    if (view[4,4]==3) MapMaze(xpos=-0.05,ypos=0.3,fact=0.9)
    if (view[4,5]==3) MapMaze(xpos=0.5,ypos=0.3,fact=0.9)
    if (view[4,6]==3) MapMaze(xpos=1.05,ypos=0.3,fact=0.9)
  }
}
#######################################################################################
#######################################################################################

#Wood in View#
##############
WoodDraw<-function(view){
  
  if (4 %in% view){
    
    #Line 1 Wood
    if (view[1,1]==4) Wood(xpos=-0.02,ypos=0.79,fact=0.15)
    if (view[1,2]==4) Wood(xpos=0.13,ypos=0.79,fact=0.15)
    if (view[1,3]==4) Wood(xpos=0.26,ypos=0.79,fact=0.15)
    if (view[1,4]==4) Wood(xpos=0.38,ypos=0.79,fact=0.15)
    if (view[1,5]==4) Wood(xpos=0.5,ypos=0.79,fact=0.15)
    if (view[1,6]==4) Wood(xpos=0.62,ypos=0.79,fact=0.15)
    if (view[1,7]==4) Wood(xpos=0.74,ypos=0.79,fact=0.15)
    if (view[1,8]==4) Wood(xpos=0.86,ypos=0.79,fact=0.15)
    if (view[1,9]==4) Wood(xpos=1.02,ypos=0.79,fact=0.15)
    #Line 2 Wood  
    if (view[2,2]==4) Wood(xpos=-0.02,ypos=0.74,fact=0.20)
    if (view[2,3]==4) Wood(xpos=0.14,ypos=0.74,fact=0.20)
    if (view[2,4]==4) Wood(xpos=0.32,ypos=0.74,fact=0.20)
    if (view[2,5]==4) Wood(xpos=0.5,ypos=0.74,fact=0.20)
    if (view[2,6]==4) Wood(xpos=0.68,ypos=0.74,fact=0.20)
    if (view[2,7]==4) Wood(xpos=0.85,ypos=0.74,fact=0.20)
    if (view[2,8]==4) Wood(xpos=1.02,ypos=0.74,fact=0.20)
    #Line 3 Wood
    if (view[3,3]==4) Wood(xpos=-0.1,ypos=0.62,fact=0.4)
    if (view[3,4]==4) Wood(xpos=0.2,ypos=0.62,fact=0.4)
    if (view[3,5]==4) Wood(xpos=0.5,ypos=0.62,fact=0.4)
    if (view[3,6]==4) Wood(xpos=0.8,ypos=0.62,fact=0.4)
    if (view[3,7]==4) Wood(xpos=1.09,ypos=0.62,fact=0.4)
    #Line 4 Wood
    if (view[4,4]==4) Wood(xpos=-0.06,ypos=0.36,fact=0.9)
    if (view[4,5]==4) Wood(xpos=0.5,ypos=0.36,fact=0.9)
    if (view[4,6]==4) Wood(xpos=1.06,ypos=0.36,fact=0.9)
  }
}
#######################################################################################
#######################################################################################

rect(xleft=0.11,xright=0.58,ybottom=0.01,ytop=0.04,col="dodgerblue2",border=NA)

#Hammer in View#
##############
HammerDraw<-function(view){
  
  if (5 %in% view){
    
    #Line 1 Hammer
    if (view[1,1]==5) Hammer(xpos=-0.02,ypos=0.8,fact=0.29)
    if (view[1,2]==5) Hammer(xpos=0.13,ypos=0.8,fact=0.29)
    if (view[1,3]==5) Hammer(xpos=0.26,ypos=0.8,fact=0.29)
    if (view[1,4]==5) Hammer(xpos=0.38,ypos=0.8,fact=0.29)
    if (view[1,5]==5) Hammer(xpos=0.5,ypos=0.8,fact=0.29)
    if (view[1,6]==5) Hammer(xpos=0.62,ypos=0.8,fact=0.29)
    if (view[1,7]==5) Hammer(xpos=0.74,ypos=0.8,fact=0.29)
    if (view[1,8]==5) Hammer(xpos=0.86,ypos=0.8,fact=0.29)
    if (view[1,9]==5) Hammer(xpos=1.02,ypos=0.8,fact=0.29)
    #Line 2 Hammer  
    if (view[2,2]==5) Hammer(xpos=-0.02,ypos=0.74,fact=0.35)
    if (view[2,3]==5) Hammer(xpos=0.14,ypos=0.74,fact=0.35)
    if (view[2,4]==5) Hammer(xpos=0.32,ypos=0.74,fact=0.35)
    if (view[2,5]==5) Hammer(xpos=0.5,ypos=0.74,fact=0.35)
    if (view[2,6]==5) Hammer(xpos=0.68,ypos=0.74,fact=0.35)
    if (view[2,7]==5) Hammer(xpos=0.85,ypos=0.74,fact=0.35)
    if (view[2,8]==5) Hammer(xpos=1.02,ypos=0.74,fact=0.35)
    #Line 3 Hammer
    if (view[3,3]==5) Hammer(xpos=-0.05,ypos=0.61,fact=0.4)
    if (view[3,4]==5) Hammer(xpos=0.2,ypos=0.61,fact=0.4)
    if (view[3,5]==5) Hammer(xpos=0.5,ypos=0.61,fact=0.4)
    if (view[3,6]==5) Hammer(xpos=0.8,ypos=0.61,fact=0.4)
    if (view[3,7]==5) Hammer(xpos=1.05,ypos=0.61,fact=0.4)
    #Line 4 Hammer
    if (view[4,4]==5) Hammer(xpos=-0.06,ypos=0.36,fact=0.9)
    if (view[4,5]==5) Hammer(xpos=0.5,ypos=0.36,fact=0.9)
    if (view[4,6]==5) Hammer(xpos=1.06,ypos=0.36,fact=0.9)
  }
}
#######################################################################################
#######################################################################################

#Sword in View#
###############
SwordDraw<-function(view){
  
  if (6 %in% view){
    
    #Line 1 Sword
    if (view[1,1]==6) Sword(xpos=0,ypos=0.81,fact=0.1)
    if (view[1,2]==6) Sword(xpos=0.13,ypos=0.81,fact=0.1)
    if (view[1,3]==6) Sword(xpos=0.26,ypos=0.81,fact=0.1)
    if (view[1,4]==6) Sword(xpos=0.38,ypos=0.81,fact=0.1)
    if (view[1,5]==6) Sword(xpos=0.5,ypos=0.81,fact=0.1)
    if (view[1,6]==6) Sword(xpos=0.62,ypos=0.81,fact=0.1)
    if (view[1,7]==6) Sword(xpos=0.74,ypos=0.81,fact=0.1)
    if (view[1,8]==6) Sword(xpos=0.86,ypos=0.81,fact=0.1)
    if (view[1,9]==6) Sword(xpos=1,ypos=0.81,fact=0.1)
    #Line 2 Sword  
    if (view[2,2]==6) Sword(xpos=-0.08,ypos=0.78,fact=0.28)
    if (view[2,3]==6) Sword(xpos=0.13,ypos=0.78,fact=0.28)
    if (view[2,4]==6) Sword(xpos=0.32,ypos=0.78,fact=0.28)
    if (view[2,5]==6) Sword(xpos=0.5,ypos=0.78,fact=0.28)
    if (view[2,6]==6) Sword(xpos=0.68,ypos=0.78,fact=0.28)
    if (view[2,7]==6) Sword(xpos=0.85,ypos=0.78,fact=0.28)
    if (view[2,8]==6) Sword(xpos=1.02,ypos=0.78,fact=0.28)
    #Line 3 Sword
    if (view[3,3]==6) Sword(xpos=-0.13,ypos=0.7,fact=0.5)
    if (view[3,4]==6) Sword(xpos=0.18,ypos=0.7,fact=0.5)
    if (view[3,5]==6) Sword(xpos=0.5,ypos=0.7,fact=0.5)
    if (view[3,6]==6) Sword(xpos=0.82,ypos=0.7,fact=0.5)
    if (view[3,7]==6) Sword(xpos=1.1,ypos=0.7,fact=0.5)
    #Line 4 Sword
    if (view[4,4]==6) Sword(xpos=-0.1,ypos=0.55,fact=1)
    if (view[4,5]==6) Sword(xpos=0.5,ypos=0.55,fact=1)
    if (view[4,6]==6) Sword(xpos=1.1,ypos=0.55,fact=1)
  }
}
#######################################################################################
#######################################################################################

#Hole in View#
###############
HoleDraw<-function(view){
  
  if (31 %in% view){
       
    #Line 1 Hole
    if (view[1,1]==31) Hole(xpos=0,ypos=0.79,fact=0.1,Wood=F)
    if (view[1,2]==31) Hole(xpos=0.13,ypos=0.79,fact=0.1,Wood=F)
    if (view[1,3]==31) Hole(xpos=0.26,ypos=0.79,fact=0.1,Wood=F)
    if (view[1,4]==31) Hole(xpos=0.38,ypos=0.79,fact=0.1,Wood=F)
    if (view[1,5]==31) Hole(xpos=0.5,ypos=0.79,fact=0.1,Wood=F)
    if (view[1,6]==31) Hole(xpos=0.62,ypos=0.79,fact=0.1,Wood=F)
    if (view[1,7]==31) Hole(xpos=0.74,ypos=0.79,fact=0.1,Wood=F)
    if (view[1,8]==31) Hole(xpos=0.86,ypos=0.79,fact=0.1,Wood=F)
    if (view[1,9]==31) Hole(xpos=1,ypos=0.79,fact=0.1,Wood=F)
    #Line 2 Hole  
    if (view[2,2]==31) Hole(xpos=-0.06,ypos=0.73,fact=0.2,Wood=F)
    if (view[2,3]==31) Hole(xpos=0.13,ypos=0.73,fact=0.2,Wood=F)
    if (view[2,4]==31) Hole(xpos=0.32,ypos=0.73,fact=0.2,Wood=F)
    if (view[2,5]==31) Hole(xpos=0.5,ypos=0.73,fact=0.2,Wood=F)
    if (view[2,6]==31) Hole(xpos=0.68,ypos=0.73,fact=0.2,Wood=F)
    if (view[2,7]==31) Hole(xpos=0.87,ypos=0.73,fact=0.2,Wood=F)
    if (view[2,8]==31) Hole(xpos=1.06,ypos=0.73,fact=0.2,Wood=F)
    #Line 3 Hole
    if (view[3,3]==31) Hole(xpos=-0.15,ypos=0.61,fact=0.45,Wood=F)
    if (view[3,4]==31) Hole(xpos=0.18,ypos=0.61,fact=0.45,Wood=F)
    if (view[3,5]==31) Hole(xpos=0.5,ypos=0.61,fact=0.45,Wood=F)
    if (view[3,6]==31) Hole(xpos=0.82,ypos=0.61,fact=0.45,Wood=F)
    if (view[3,7]==31) Hole(xpos=1.18,ypos=0.61,fact=0.45,Wood=F)
    #Line 4 Hole
    if (view[4,4]==31) Hole(xpos=-0.1,ypos=0.38,fact=0.9,Wood=F)
    if (view[4,5]==31) Hole(xpos=0.5,ypos=0.38,fact=0.85,Wood=F)
    if (view[4,6]==31) Hole(xpos=1.1,ypos=0.38,fact=0.9,Wood=F)
  }
}
#######################################################################################
#######################################################################################

#Hole with Wood in View#
########################
HoleWoodDraw<-function(view){
  
  if (32 %in% view){
    
    #Line 1 Hole
    if (view[1,1]==32) Hole(xpos=0,ypos=0.79,fact=0.1,Wood=T)
    if (view[1,2]==32) Hole(xpos=0.13,ypos=0.79,fact=0.1,Wood=T)
    if (view[1,3]==32) Hole(xpos=0.26,ypos=0.79,fact=0.1,Wood=T)
    if (view[1,4]==32) Hole(xpos=0.38,ypos=0.79,fact=0.1,Wood=T)
    if (view[1,5]==32) Hole(xpos=0.5,ypos=0.79,fact=0.1,Wood=T)
    if (view[1,6]==32) Hole(xpos=0.62,ypos=0.79,fact=0.1,Wood=T)
    if (view[1,7]==32) Hole(xpos=0.74,ypos=0.79,fact=0.1,Wood=T)
    if (view[1,8]==32) Hole(xpos=0.86,ypos=0.79,fact=0.1,Wood=T)
    if (view[1,9]==32) Hole(xpos=1,ypos=0.79,fact=0.1,Wood=T)
    #Line 2 Hole  
    if (view[2,2]==32) Hole(xpos=-0.06,ypos=0.73,fact=0.2,Wood=T)
    if (view[2,3]==32) Hole(xpos=0.13,ypos=0.73,fact=0.2,Wood=T)
    if (view[2,4]==32) Hole(xpos=0.32,ypos=0.73,fact=0.2,Wood=T)
    if (view[2,5]==32) Hole(xpos=0.5,ypos=0.73,fact=0.2,Wood=T)
    if (view[2,6]==32) Hole(xpos=0.68,ypos=0.73,fact=0.2,Wood=T)
    if (view[2,7]==32) Hole(xpos=0.87,ypos=0.73,fact=0.2,Wood=T)
    if (view[2,8]==32) Hole(xpos=1.06,ypos=0.73,fact=0.2,Wood=T)
    #Line 3 Hole
    if (view[3,3]==32) Hole(xpos=-0.15,ypos=0.61,fact=0.45,Wood=T)
    if (view[3,4]==32) Hole(xpos=0.18,ypos=0.61,fact=0.45,Wood=T)
    if (view[3,5]==32) Hole(xpos=0.5,ypos=0.61,fact=0.45,Wood=T)
    if (view[3,6]==32) Hole(xpos=0.82,ypos=0.61,fact=0.45,Wood=T)
    if (view[3,7]==32) Hole(xpos=1.18,ypos=0.61,fact=0.45,Wood=T)
    #Line 4 Hole
    if (view[4,4]==32) Hole(xpos=-0.1,ypos=0.38,fact=0.9,Wood=T)
    if (view[4,5]==32) Hole(xpos=0.5,ypos=0.38,fact=0.85,Wood=T)
    if (view[4,6]==32) Hole(xpos=1.1,ypos=0.38,fact=0.9,Wood=T)
    #Line 5 Hole
    if (view[5,5]==32) Hole(xpos=0.5,ypos=0,fact=1,Wood=T)
  }
}
#######################################################################################
#######################################################################################

rect(xleft=0.11,xright=0.67,ybottom=0.01,ytop=0.04,col="dodgerblue2",border=NA)

#Tree Draw#
###########
Tree<-function(xpos=0.5,ypos=0.1,fact=0.5){
  polygon(x=c(xpos-0.04*fact,xpos-0.04*fact,xpos+0.04*fact,xpos+0.04*fact),y=c(ypos-0.25*fact,ypos-0.45*fact,ypos-0.45*fact,ypos-0.25*fact),col="tan4",border="black",lwd=4*fact)
  polygon(x=c(xpos,xpos-0.13*fact*1.8,xpos-0.05*fact*1.8,xpos+0.13*fact*1.8),
          y=c(ypos-0.2*fact*1.8,ypos-0.2*fact*1.8,ypos+0.02*fact*1.8,ypos-0.2*fact*1.8),
          col="darkgreen",border=NA)
  lines(x=c(xpos,xpos-0.13*fact*1.8,xpos-0.05*fact*1.8,xpos+0.13*fact*1.8,xpos),
        y=c(ypos-0.2*fact*1.8,ypos-0.2*fact*1.8,ypos+0.02*fact*1.8,ypos-0.2*fact*1.8,ypos-0.2*fact*1.8),
        col="black",lwd=3*fact)
  polygon(x=c(xpos,xpos-0.17*fact*1.3,xpos+0.03*fact*1.3,xpos+0.17*fact*1.3,xpos+0.09*fact*1.3,xpos+0.21*fact*1.3,xpos-0.07*fact*1.3),
          y=c(ypos-0.1*fact*1.3,ypos-0.1*fact*1.3,ypos+0.12*fact*1.3,ypos-0.1*fact*1.3,ypos-0.15*fact*1.3,ypos-0.21*fact*1.3,ypos-0.22*fact*1.3),
          col="darkgreen",border=NA)
  lines(x=c(xpos,xpos-0.17*fact*1.3,xpos+0.03*fact*1.3,xpos+0.17*fact*1.3,xpos+0.09*fact*1.3,xpos+0.21*fact*1.3,xpos-0.07*fact*1.3),
        y=c(ypos-0.1*fact*1.3,ypos-0.1*fact*1.3,ypos+0.12*fact*1.3,ypos-0.1*fact*1.3,ypos-0.15*fact*1.3,ypos-0.21*fact*1.3,ypos-0.22*fact*1.3),
        col="black",lwd=3*fact)
  polygon(x=c(xpos,xpos-0.17*fact,xpos+0.03*fact,xpos+0.17*fact,xpos+0.09*fact,xpos+0.21*fact,xpos+0.05*fact),
          y=c(ypos,ypos,ypos+0.32*fact,ypos+0.07*fact,ypos+0.05*fact,ypos-0.01*fact,ypos-0.08*fact),
          col="darkgreen",border=NA)
  lines(x=c(xpos,xpos-0.17*fact,xpos+0.03*fact,xpos+0.17*fact,xpos+0.09*fact,xpos+0.21*fact,xpos+0.05*fact),
        y=c(ypos,ypos,ypos+0.32*fact,ypos+0.07*fact,ypos+0.05*fact,ypos-0.01*fact,ypos-0.08*fact),
        col="black",lwd=3*fact)
}
#######################################################################################
#######################################################################################

#AttackerSleep#
###############
AttackerSleep<-function(xpos=0.5,ypos=0.5,fact=1,level=21,eyes="closed",mouth=1){
  
  if (eyes!="attack"){
    points(x=xpos,y=ypos,cex=fact*15,col=c("blue","green","purple")[level-20],pch=21,bg=c("blue","green","purple")[level-20])
  }
  
  if (eyes=="attack"){
    
    belowAtt.y<-NULL
    topAtt.y<-NULL
    leftAtt.x<-NULL
    rightAtt.x<-NULL
    
    for (i in 1:100){
      belowAtt.y<-c(belowAtt.y,c(ypos,sample(seq(ypos-0.15*fact,ypos,by=0.01),1)))
      topAtt.y<-c(topAtt.y,c(ypos,sample(seq(ypos,ypos+0.15*fact,by=0.01),1)))
      leftAtt.x<-c(leftAtt.x,c(xpos,sample(seq(xpos-0.15*fact,xpos,by=0.01),1)))
      rightAtt.x<-c(rightAtt.x,c(xpos,sample(seq(xpos,xpos+0.15*fact,by=0.01),1)))
    }
    
    #Attacker Normal
    lines(c(belowAtt.y,belowAtt.y,topAtt.y,topAtt.y)~c(leftAtt.x,rightAtt.x,leftAtt.x,rightAtt.x),col=c("blue","green","purple")[level-20],lwd=2)
    points(x=xpos-0.04*fact,y=ypos+0.03*fact,col="black",pch=19,lwd=20*fact)
    points(x=xpos+0.04*fact,y=ypos+0.03*fact,col="black",pch=19,lwd=20*fact)
    points(x=xpos-0.035*fact,y=ypos+0.025*fact,col="red",pch=19,lwd=10*fact)
    points(x=xpos+0.035*fact,y=ypos+0.025*fact,col="red",pch=19,lwd=10*fact)
    points(x=seq(xpos-0.04*fact,xpos+0.04*fact,0.01),y=rep(ypos-0.02*fact,9),col="black",pch=25,cex=1*fact,lwd=1,bg="black")    
    points(x=seq(xpos-0.04*fact,xpos+0.04*fact,0.01),y=rep(ypos-0.06*fact,9),col="black",pch=24,cex=1*fact,lwd=1,bg="black")     
  }
  
  if (eyes=="closed"){
    points(x=xpos-0.04*fact,y=ypos+0.03*fact,col="black",pch=19,lwd=20*fact)
    points(x=xpos+0.04*fact,y=ypos+0.03*fact,col="black",pch=19,lwd=20*fact)
    text(x=xpos-0.04*fact,y=ypos+0.03*fact,col="white",cex=1*fact,"---")
    text(x=xpos+0.04*fact,y=ypos+0.03*fact,col="white",cex=1*fact,"---")
  }
  if (eyes=="open"){
    points(x=xpos-0.04,y=ypos+0.03,col="black",pch=19,lwd=20*fact)
    points(x=xpos+0.04,y=ypos+0.03,col="black",pch=19,lwd=20*fact)
    points(x=xpos-0.035,y=ypos+0.025,col="red",pch=19,lwd=10*fact)
    points(x=xpos+0.035,y=ypos+0.025,col="red",pch=19,lwd=10*fact)
  }
  if (mouth==1){text(x=xpos,y=ypos-0.05*fact,col="black",cex=1*fact,"--------")}
  if (mouth==2){
    points(x=seq(xpos-0.04,xpos+0.04,0.01),y=rep(ypos-0.04,9),col="black",pch=25,cex=1*fact,bg="black")    
    points(x=seq(xpos-0.04,xpos+0.04,0.01),y=rep(ypos-0.05,9),col="black",pch=24,cex=1*fact,bg="black")     
  }
  if (mouth==3){
    points(x=seq(xpos-0.04,xpos+0.04,0.01),y=rep(ypos-0.02,9),col="black",pch=25,cex=1*fact,bg="black")    
    points(x=seq(xpos-0.04,xpos+0.04,0.01),y=rep(ypos-0.06,9),col="black",pch=24,cex=1*fact,bg="black")     
  }
  
}
#######################################################################################
#######################################################################################

rect(xleft=0.11,xright=0.71,ybottom=0.01,ytop=0.04,col="dodgerblue2",border=NA)

#Attacker Wake Up Animation#
############################
AttackerWakeUp<-function(Inventory,Health,Strength,view,Position,Grid){
  
  position.x<-which(view[c(4,5),c(4,5,6)]  > 20 & view[c(4,5),c(4,5,6)]  < 24, arr.ind = TRUE)[2] #First Def of Position
  position.y<-which(view[c(4,5),c(4,5,6)]  > 20 & view[c(4,5),c(4,5,6)]  < 24, arr.ind = TRUE)[1] #First Def of Position
  
  AttackerSleep(xpos=0.5,ypos=0.5,fact=1,level=view[c(4,5),c(4,5,6)][position.y,position.x],eyes="closed",mouth=1)
  Pause(0.6)
  AttackerSleep(xpos=0.5,ypos=0.5,fact=1,level=view[c(4,5),c(4,5,6)][position.y,position.x],eyes="open",mouth=1)
  Pause(0.6)
  AttackerSleep(xpos=0.5,ypos=0.5,fact=1,level=view[c(4,5),c(4,5,6)][position.y,position.x],eyes="open",mouth=2)
  Pause(0.6)
  AttackerSleep(xpos=0.5,ypos=0.5,fact=1,level=view[c(4,5),c(4,5,6)][position.y,position.x],eyes="open",mouth=3)
  Pause(0.6)
  
  BasicView(view)
  
  MedikitDraw(view)   #Object 1
  KeyDraw(view)       #Object 2
  MapDraw(view)       #Object 3
  WoodDraw(view)      #Object 4
  HammerDraw(view)    #Object 5
  SwordDraw(view)     #Object 6
  TorchDraw(view)     #Object 8
  HoleDraw(view)      #Object 31
  HoleWoodDraw(view)  #Object 32 with Wood
  #
  DrawWall.L1(view)
  DrawWall.L2(view)
  DrawWall.L3(view)
  DrawWall.L4(view)
  DrawWall.L5(view)
  
  Fog(Position,Grid,Inventory)

  InteractFields(Inventory,Health,Strength)

  
  AttackerSleep(xpos=0.5,ypos=0.5,fact=1,level=view[c(4,5),c(4,5,6)][position.y,position.x],eyes="attack",mouth=0)
  Pause(0.6)
  
  BasicView(view)

  MedikitDraw(view)   #Object 1
  KeyDraw(view)       #Object 2
  MapDraw(view)       #Object 3
  WoodDraw(view)      #Object 4
  HammerDraw(view)    #Object 5
  SwordDraw(view)     #Object 6
  TorchDraw(view)     #Object 8
  HoleDraw(view)      #Object 31
  HoleWoodDraw(view)  #Object 32 with Wood

  DrawWall.L1(view)
  DrawWall.L2(view)
  DrawWall.L3(view)
  DrawWall.L4(view)
  DrawWall.L5(view)
  
  Fog(Position,Grid,Inventory)
  
  InteractFields(Inventory,Health,Strength)
  
  AttackerSleep(xpos=sample(seq(0.2,0.8,by=0.1),1),ypos=sample(seq(0.2,0.8,by=0.1),1),fact=1,level=view[c(4,5),c(4,5,6)][position.y,position.x],eyes="attack",mouth=0)
  Pause(0.6)
  
  BasicView(view)
  
  MedikitDraw(view)   #Object 1
  KeyDraw(view)       #Object 2
  MapDraw(view)       #Object 3
  WoodDraw(view)      #Object 4
  HammerDraw(view)    #Object 5
  SwordDraw(view)     #Object 6
  TorchDraw(view)     #Object 8
  HoleDraw(view)      #Object 31
  HoleWoodDraw(view)  #Object 32 with Wood
  #
  DrawWall.L1(view)
  DrawWall.L2(view)
  DrawWall.L3(view)
  DrawWall.L4(view)
  DrawWall.L5(view)
  
  Fog(Position,Grid,Inventory)
  
  InteractFields(Inventory,Health,Strength)
  
  AttackerSleep(xpos=sample(seq(0.2,0.8,by=0.1),1),ypos=sample(seq(0.2,0.8,by=0.1),1),fact=1,level=view[c(4,5),c(4,5,6)][position.y,position.x],eyes="attack",mouth=0)
  Pause(0.6)
  
  BasicView(view)
  #
  MedikitDraw(view)   #Object 1
  KeyDraw(view)       #Object 2
  MapDraw(view)       #Object 3
  WoodDraw(view)      #Object 4
  HammerDraw(view)    #Object 5
  SwordDraw(view)     #Object 6
  TorchDraw(view)     #Object 8
  HoleDraw(view)      #Object 31
  HoleWoodDraw(view)  #Object 32 with Wood
  #
  DrawWall.L1(view)
  DrawWall.L2(view)
  DrawWall.L3(view)
  DrawWall.L4(view)
  DrawWall.L5(view)
  
  Fog(Position,Grid,Inventory)
  
  InteractFields(Inventory,Health,Strength)
   
  AttackerSleep(xpos=sample(seq(0.2,0.8,by=0.1),1),ypos=sample(seq(0.2,0.8,by=0.1),1),fact=1,level=view[c(4,5),c(4,5,6)][position.y,position.x],eyes="attack",mouth=0)
  
  Pause(0.6)
}
#######################################################################################
#######################################################################################

#Create View From Grid#
#######################
CreateView<-function(Position,Grid,Map,Inventory){
  
  position.x<-which(Position == 1, arr.ind = TRUE)[2] #First Def of Position
  position.y<-which(Position == 1, arr.ind = TRUE)[1] #First Def of Position
    
  view<-Grid[(position.y-4):(position.y+3),(position.x-4):(position.x+4)]
  
  if (3 %in% Inventory){
  Map[(position.y-1):(position.y),(position.x-1):(position.x+1)]<-Grid[(position.y-1):(position.y),(position.x-1):(position.x+1)]
  Map[which(Map<80)]<-1
  Map[which(Map>79)]<-NA
  }
  return(list(view,Map))
} #Returns view and Map
#######################################################################################
#######################################################################################

rect(xleft=0.11,xright=0.78,ybottom=0.01,ytop=0.04,col="dodgerblue2",border=NA)

#Move Forward#
##############
MoveForward<-function(Position,Grid){
  
  position.x<-which(Position == 1, arr.ind = TRUE)[2] #First Def of Position
  position.y<-which(Position == 1, arr.ind = TRUE)[1] #First Def of Position
  
  if (Grid[position.y-1,position.x]<80){
    Position[position.y,position.x]<-NA
    Position[position.y-1,position.x]<-1
  }
  return(Position)
} #Returns Position
#######################################################################################
#######################################################################################

#Rotate Function#
#################
rotate <- function(x) t(apply(x, 2, rev))
#######################################################################################
#######################################################################################

#Pause While Loop Function#
###########################
Pause<-function(sec){
  Time<-0
  TimeStartEasy1<-Sys.time()
  while (Time<sec){
    Time<-as.numeric(Sys.time()-TimeStartEasy1)
  }
}
#######################################################################################
#######################################################################################

rect(xleft=0.11,xright=0.8,ybottom=0.01,ytop=0.04,col="dodgerblue2",border=NA)

#PickUp Function#
#################
#################
PickUp<-function(Inventory,Grid,Position){
  
  position.x<-which(Position == 1, arr.ind = TRUE)[2]
  position.y<-which(Position == 1, arr.ind = TRUE)[1]
  
  if (length(which(Inventory==0))>0 & Grid[(position.y-1),position.x] > 0 & Grid[(position.y-1),position.x] < 10){
  
    Inventory[which(Inventory==0)[1]]<-Grid[(position.y-1),position.x]
    Grid[(position.y-1),position.x]<-77    
  }
  if (length(which(Inventory==0))>0 & Grid[(position.y-1),position.x] == 32){
    
    Inventory[which(Inventory==0)[1]]<-4
    Grid[(position.y-1),position.x]<-31   
  }
  return(list(Grid,Inventory))
}
#######################################################################################
#######################################################################################

#Use Inventory#
###############
UseInventory<-function(cursor,Inventory,view,Health,Strength,Grid,Position,Map){
  
  #Field 1
  if (cursor$x > -0.025 & cursor$x < 0.075){
    if (Inventory[1]==1){Health<-Health+0.25;Inventory[1]<-0}
    if (Inventory[1]==2 & view[4,5]==99){
      End<-EndSeq(Inventory,Health,Strength,Level)
      run<-End[[1]]
      Level<-End[[2]]
    }
    if (Inventory[1]==3){DrawMap(Map,Position)}
    if (Inventory[1]==4 & any(c(31,77,78)==view[4,5])){
      
      Inventory[1]<-0
      
      position.x<-which(Position == 1, arr.ind = TRUE)[2] #First Def of Position
      position.y<-which(Position == 1, arr.ind = TRUE)[1] #First Def of Position
      
      if (view[4,5]==31){Grid[(position.y-1),position.x]<-32}
      if (view[4,5]==77 | view[4,5]==78){Grid[(position.y-1),position.x]<-4}
    }
    if (Inventory[1]==5){Strength<-Strength+0.1;Inventory[1]<-0}
    if (Inventory[1]==6){Strength<-Strength+0.3;Inventory[1]<-0}
  if (Inventory[1]==8 & any(c(77,78)==view[4,5])){
    
    Inventory[1]<-0
    
    position.x<-which(Position == 1, arr.ind = TRUE)[2] #First Def of Position
    position.y<-which(Position == 1, arr.ind = TRUE)[1] #First Def of Position
    
    Grid[(position.y-1),position.x]<-8
  }
}
  #Field 2
  if (cursor$x > 0.075 & cursor$x < 0.175){
    if (Inventory[2]==1){Health<-Health+0.25;Inventory[2]<-0}
    if (Inventory[2]==2 & view[4,5]==99){
      End<-EndSeq(Inventory,Health,Strength,Level)
      run<-End[[1]]
      Level<-End[[2]]
    }
    if (Inventory[2]==3){DrawMap(Map,Position)}
    if (Inventory[2]==4 & any(c(31,77,78)==view[4,5])){
      
      Inventory[2]<-0
      
      position.x<-which(Position == 1, arr.ind = TRUE)[2] #First Def of Position
      position.y<-which(Position == 1, arr.ind = TRUE)[1] #First Def of Position
      
      if (view[4,5]==31){Grid[(position.y-1),position.x]<-32}
      if (view[4,5]==77 | view[4,5]==78){Grid[(position.y-1),position.x]<-4}
    }
    if (Inventory[2]==5){Strength<-Strength+0.1;Inventory[2]<-0}
    if (Inventory[2]==6){Strength<-Strength+0.3;Inventory[2]<-0}
    if (Inventory[2]==8 & any(c(77,78)==view[4,5])){
      
      Inventory[2]<-0
      
      position.x<-which(Position == 1, arr.ind = TRUE)[2] #First Def of Position
      position.y<-which(Position == 1, arr.ind = TRUE)[1] #First Def of Position
      
      Grid[(position.y-1),position.x]<-8
    }
  }
  #Field 3
  if (cursor$x > 0.175 & cursor$x < 0.275){
    if (Inventory[3]==1){Health<-Health+0.25;Inventory[3]<-0}
    if (Inventory[3]==2 & view[4,5]==99){
      End<-EndSeq(Inventory,Health,Strength,Level)
      run<-End[[1]]
      Level<-End[[2]]
    }
    if (Inventory[3]==3){DrawMap(Map,Position)}
    if (Inventory[3]==4 & any(c(31,77,78)==view[4,5])){
      
      Inventory[3]<-0
      
      position.x<-which(Position == 1, arr.ind = TRUE)[2] #First Def of Position
      position.y<-which(Position == 1, arr.ind = TRUE)[1] #First Def of Position
      
      if (view[4,5]==31){Grid[(position.y-1),position.x]<-32}
      if (view[4,5]==77 | view[4,5]==78){Grid[(position.y-1),position.x]<-4}
    }
    if (Inventory[3]==5){Strength<-Strength+0.1;Inventory[3]<-0}
    if (Inventory[3]==6){Strength<-Strength+0.3;Inventory[3]<-0}
    if (Inventory[3]==8 & any(c(77,78)==view[4,5])){
      
      Inventory[3]<-0
      
      position.x<-which(Position == 1, arr.ind = TRUE)[2] #First Def of Position
      position.y<-which(Position == 1, arr.ind = TRUE)[1] #First Def of Position
      
      Grid[(position.y-1),position.x]<-8
    }
  }
  return(list(Health,Strength,Grid,Inventory,run,Level))
}
#######################################################################################
#######################################################################################

rect(xleft=0.11,xright=0.84,ybottom=0.01,ytop=0.04,col="dodgerblue2",border=NA)

#Attack Function#
########################
Attack<-function(x=0.5,y=0.5,view,Inventory,Health,Strength,Position,Grid){
  
  Attacker.Health<-1
  
  position.x<-which(view[c(4,5),c(4,5,6)] > 20 & view[c(4,5),c(4,5,6)] < 24, arr.ind = TRUE)[2] #First Def of Position
  position.y<-which(view[c(4,5),c(4,5,6)] > 20 & view[c(4,5),c(4,5,6)] < 24, arr.ind = TRUE)[1] #First Def of Position
  
  colattacker<-c("blue","green","purple")[view[c(4,5),c(4,5,6)][position.y,position.x]-20]
  
  while(Attacker.Health>0 & Health>0){
    
    BasicView(view)
    #
    MedikitDraw(view)   #Object 1
    KeyDraw(view)       #Object 2
    MapDraw(view)       #Object 3
    WoodDraw(view)      #Object 4
    HammerDraw(view)    #Object 5
    SwordDraw(view)     #Object 6
    TorchDraw(view)     #Object 8
    HoleDraw(view)      #Object 31
    HoleWoodDraw(view)  #Object 32 with Wood
    
    DrawWall.L1(view)
    DrawWall.L2(view)
    DrawWall.L3(view)
    DrawWall.L4(view)
    DrawWall.L5(view)
    
    Fog(Position,Grid,Inventory)
    
    InteractFields(Inventory,Health,Strength)
    
    
    rndatt<-sample(1:4,4)
    attackercharacteristics<-matrix("h",ncol=2,nrow=2)
    attackercharacteristics[rndatt[1:(view[c(4,5),c(4,5,6)][position.y,position.x]-20)]]<-"a"
    
    x.att<-x+sample(seq(-0.4,+0.4,by=0.1),1)
    y.att<-y+sample(seq(-0.3,+0.4,by=0.1),1)
    
    belowAtt.y<-NULL
    topAtt.y<-NULL
    leftAtt.x<-NULL
    rightAtt.x<-NULL
    
    for (i in 1:(10+round(90*Attacker.Health))){
      belowAtt.y<-c(belowAtt.y,c(y.att,sample(seq(y.att-0.15,y.att,by=0.01),1)))
      topAtt.y<-c(topAtt.y,c(y.att,sample(seq(y.att,y.att+0.15,by=0.01),1)))
      leftAtt.x<-c(leftAtt.x,c(x.att,sample(seq(x.att-0.15,x.att,by=0.01),1)))
      rightAtt.x<-c(rightAtt.x,c(x.att,sample(seq(x.att,x.att+0.15,by=0.01),1)))
    }
    
    #Attacker Normal
    lines(c(belowAtt.y,belowAtt.y,topAtt.y,topAtt.y)~c(leftAtt.x,rightAtt.x,leftAtt.x,rightAtt.x),col=colattacker,lwd=2)
    points(x=x.att-0.05,y=y.att+0.04,col="black",pch=19,lwd=20)
    points(x=x.att-0.045,y=y.att+0.04,col="red",pch=19,lwd=10)
    points(x=x.att+0.05,y=y.att+0.04,col="black",pch=19,lwd=20)
    points(x=x.att+0.045,y=y.att+0.04,col="red",pch=19,lwd=10)
    points(x=seq(x.att-0.04,x.att+0.04,0.01),y=rep(y.att-0.02,9),col="black",pch=25,lwd=1,bg="black")    
    points(x=seq(x.att-0.04,x.att+0.04,0.01),y=rep(y.att-0.07,9),col="black",pch=24,lwd=1,bg="black")    
    
    click.attack<-locator(1)
    
    #Attacker Hit top-left
    if (click.attack$x<x.att & click.attack$x>x.att-0.15 & click.attack$y>y.att & click.attack$y<y.att+0.15){
      
      lines(c(topAtt.y)~c(leftAtt.x),col="red",lwd=2)
      points(x=x.att-0.05,y=y.att+0.04,col="black",pch=19,lwd=20)
      points(x=x.att-0.045,y=y.att+0.04,col="red",pch=19,lwd=10)
      
      if (attackercharacteristics[1,1]=="a"){
        AttackSeq()
        Health<-Health-0.1
      }
      if (attackercharacteristics[1,1]=="h"){
        Attacker.Health<-Attacker.Health-(0.2+Strength*0.6)
      }
      Pause(1)
    }
    
    
    #Attacker Hit top-right
    if (click.attack$x>x.att & click.attack$x<x.att+0.15 & click.attack$y>y.att & click.attack$y<y.att+0.15){
      
      lines(c(topAtt.y)~c(rightAtt.x),col="red",lwd=2)
      points(x=x.att+0.05,y=y.att+0.04,col="black",pch=19,lwd=20)
      points(x=x.att+0.045,y=y.att+0.04,col="red",pch=19,lwd=10)
      
      if (attackercharacteristics[1,2]=="a"){
        AttackSeq()
        Health<-Health-0.1
      }
      if (attackercharacteristics[1,2]=="h"){
        Attacker.Health<-Attacker.Health-(0.1+Strength*0.6)
      }
      Pause(1)
    }
    
    #Attacker Hit below-left
    if (click.attack$x<x.att & click.attack$x>x.att-0.15 & click.attack$y<y.att & click.attack$y>y.att-0.15){
      
      lines(c(belowAtt.y)~c(leftAtt.x),col="red",lwd=2)
      points(x=seq(x.att-0.04,x.att+0.04,0.01),y=rep(y.att-0.02,9),col="black",pch=25,lwd=1,bg="black")    
      points(x=seq(x.att-0.04,x.att+0.04,0.01),y=rep(y.att-0.07,9),col="black",pch=24,lwd=1,bg="black")    
      
      if (attackercharacteristics[2,1]=="a"){
        AttackSeq()
        Health<-Health-0.1
      }
      if (attackercharacteristics[2,1]=="h"){
        Attacker.Health<-Attacker.Health-(0.1+Strength*0.6)
      }
      Pause(1)
    }
    
    #Attacker Hit below-right
    if (click.attack$x>x.att & click.attack$x<x.att+0.15 & click.attack$y<y.att & click.attack$y>y.att-0.15){
      
      lines(c(belowAtt.y)~c(rightAtt.x),col="red",lwd=2)
      points(x=seq(x.att-0.04,x.att+0.04,0.01),y=rep(y.att-0.02,9),col="black",pch=25,lwd=1,bg="black")    
      points(x=seq(x.att-0.04,x.att+0.04,0.01),y=rep(y.att-0.07,9),col="black",pch=24,lwd=1,bg="black")    
      
      if (attackercharacteristics[2,2]=="a"){
        AttackSeq()
        Health<-Health-0.1
      }
      if (attackercharacteristics[2,2]=="h"){
        Attacker.Health<-Attacker.Health-(0.1+Strength*0.6)
      }
      Pause(1)
    }
  }
  
  if (Health<0){Health<-0}
  
  BasicView(view)
  #
  MedikitDraw(view)   #Object 1
  KeyDraw(view)       #Object 2
  MapDraw(view)       #Object 3
  WoodDraw(view)      #Object 4
  HammerDraw(view)    #Object 5
  SwordDraw(view)     #Object 6
  TorchDraw(view)     #Object 8
  HoleDraw(view)      #Object 31
  HoleWoodDraw(view)  #Object 32 with Wood
  
  DrawWall.L1(view)
  DrawWall.L2(view)
  DrawWall.L3(view)
  DrawWall.L4(view)
  DrawWall.L5(view)
  
  Fog(Position,Grid,Inventory)
  
  InteractFields(Inventory,Health,Strength)
  
  return(Health)
}
#######################################################################################
#######################################################################################

#Attack Sequence#
################
AttackSeq<-function(){
  
  plot.new()
  
  Pause(0.3)
  rect(xleft=-1,xright=2,ybottom=-1,ytop=2,col="green") 
  points(x=seq(0,1,by=0.1),y=rep(1,11),col="black",pch=25,cex=10,bg="black")
  points(x=seq(0,1,by=0.1),y=rep(0,11),col="black",pch=24,cex=10,bg="black")
  
  Pause(0.3)
  rect(xleft=-1,xright=2,ybottom=-1,ytop=2,col="red") 
  points(x=seq(0,1,by=0.1),y=rep(1,11),col="black",pch=25,cex=10,bg="black")
  points(x=seq(0,1,by=0.1),y=rep(0,11),col="black",pch=24,cex=10,bg="black")
  
  Pause(0.3)
  rect(xleft=-1,xright=2,ybottom=-1,ytop=2,col="green") 
  points(x=seq(0,1,by=0.1),y=rep(1,11),col="black",pch=25,cex=10,bg="black")
  points(x=seq(0,1,by=0.1),y=rep(0,11),col="black",pch=24,cex=10,bg="black")
  
  Pause(0.3)
  rect(xleft=-1,xright=2,ybottom=-1,ytop=2,col="red") 
  points(x=seq(0,1,by=0.1),y=rep(1,11),col="black",pch=25,cex=10,bg="black")
  points(x=seq(0,1,by=0.1),y=rep(0,11),col="black",pch=24,cex=10,bg="black")
  
  Pause(0.3)
  rect(xleft=-1,xright=2,ybottom=-1,ytop=2,col="green") 
  points(x=seq(0,1,by=0.1),y=rep(1,11),col="black",pch=25,cex=10,bg="black")
  points(x=seq(0,1,by=0.1),y=rep(0,11),col="black",pch=24,cex=10,bg="black")
  
  Pause(0.3)
  rect(xleft=-1,xright=2,ybottom=-1,ytop=2,col="red") 
  points(x=seq(0,1,by=0.1),y=rep(1,11),col="black",pch=25,cex=10,bg="black")
  points(x=seq(0,1,by=0.1),y=rep(0,11),col="black",pch=24,cex=10,bg="black")

}
#######################################################################################
#######################################################################################

#Fog in Maze#
#############
Fog<-function(Position,Grid,Inventory){
  
  position.x<-which(Position == 1, arr.ind = TRUE)[2] #First Def of Position
  position.y<-which(Position == 1, arr.ind = TRUE)[1] #First Def of Position
  
  foggy<-Grid[(position.y-2):(position.y+2),(position.x-2):(position.x+2)]
    
  if (any(foggy==78)==T){
  
  if (length(which(foggy==78))==1){fogcol<-gray.colors(1, start = 0.9, end = 0.9, gamma = 1, alpha = 0.1)}
  if (length(which(foggy==78))==2){fogcol<-gray.colors(1, start = 0.5, end = 0.5, gamma = 1, alpha = 0.4)}
  if (length(which(foggy==78))==3){fogcol<-gray.colors(1, start = 0.1, end = 0.1, gamma = 1, alpha = 0.9)}
  if (length(which(foggy==78)) >3){fogcol<-"black"}
 
  if (any(Inventory==8)==F){   
    text(y=sample(seq(-0.1,1.1,by=0.01),30,replace=T),x=sample(seq(0,1.1,by=0.01),30,replace=T),"*",cex=sample(1:10,30,replace=T),col="grey50") 
    polygon(x=c(-0.1,1.1,1.1,-0.1),y=c(-0.1,-0.1,1.1,1.1),col=fogcol,bg=fogcol)
  }
  if (any(Inventory==8)==T){   
    text(y=sample(seq(-0.1,1.1,by=0.01),30,replace=T),x=sample(seq(0,1.1,by=0.01),30,replace=T),"*",cex=sample(1:10,30,replace=T),col="grey90") 
    Torch(xpos=-0.1,ypos=0.03,fact=1.5)
  }  
 }
}
#######################################################################################
#######################################################################################

#EndSequence Dead#
##################
Dead<-function(){
  
  colordead<-gray.colors(1, start = 0.9, end = 0.9, gamma = 1, alpha = 0.1)
  
  rect(xleft=-1,xright=2,ybottom=-1,ytop=2,col="black")
  
  for (i in 1:10){
    Pause(0.4)
    rect(xleft=0.45,xright=0.55,ybottom=0.1,ytop=0.9,col=colordead,border=NA)
    rect(xleft=0.3,xright=0.45,ybottom=0.65,ytop=0.75,col=colordead,border=NA)
    rect(xleft=0.55,xright=0.7,ybottom=0.65,ytop=0.75,col=colordead,border=NA)
  }
  Pause(0.4)
  text(x=0.5,y=0.7,"R.I.P",cex=1.8)
  Pause(1)
}
#######################################################################################
#######################################################################################

#EndSequence Dead#
##################
Fall<-function(){
  plot.new()
  colordead<-gray.colors(1, start = 0.9, end = 0.9, gamma = 1, alpha = 0.1)
  
  polygon(x=c(-1,2,2,-1),y=c(-0.5,-0.5,1.5,1.5),col="grey90",density=15,angle=0,border=NA)
  polygon(x=c(-1,2,2,-1),y=c(-0.5,-0.5,1.5,1.5),col="grey90",density=15,angle=90,border=NA)
  
  Hole(xpos=0.5,ypos=0.7,fact=1.6,Wood=F)
  Pause(0.4)
  Hole(xpos=0.5,ypos=0.75,fact=2,Wood=F)
  Pause(0.4)
  Hole(xpos=0.5,ypos=0.85,fact=3,Wood=F)
  Pause(0.4)
  Hole(xpos=0.5,ypos=0.95,fact=4,Wood=F)
  Pause(0.4)
  Hole(xpos=0.5,ypos=1.5,fact=10,Wood=F)
   
  polygon(x=c(-1,2,2,-1),y=c(-0.5,-0.5,1.5,1.5),col="red",border=NA)
  Pause(0.2)
  Dead()
}
#######################################################################################
#######################################################################################

#EndSequence Door#
##################
EndSeq<-function(Inventory,Health,Strength,Level=1){
  
  if (Level==11){ColCode<-c(6,2,5);Level<-Level+1}
  if (Level==10){ColCode<-c(5,7,3);Level<-Level+1}
  if (Level==9){ColCode<-c(4,2,5);Level<-Level+1}
  if (Level==8){ColCode<-c(7,5,6);Level<-Level+1}
  if (Level==7){ColCode<-c(7,4,6);Level<-Level+1}
  if (Level==6){ColCode<-c(5,6,3);Level<-Level+1}
  if (Level==5){ColCode<-c(2,5,4);Level<-Level+1}
  if (Level==4){ColCode<-c(4,2,6);Level<-Level+1}
  if (Level==3){ColCode<-c(7,3,4);Level<-Level+1}
  if (Level==2){ColCode<-c(5,6,4);Level<-Level+1}
  if (Level==1){ColCode<-c(5,7,4);Level<-Level+1}
  
  Pause(0.6)
  
  #Door 2
  polygon(x=c(0.28,0.28,0.72,0.72),y=c(0.05,1,1,0.05),col="black",lwd=3)
  polygon(x=c(0.32,0.32,0.72,0.72),y=c(0.1,0.945,1,0.05),col="darkgoldenrod",lwd=3)
  points(x=0.35,y=0.516,pch=19,cex=2)
  Fog(Position,Grid,Inventory)
  InteractFields(Inventory,Health,Strength)
    
  Pause(0.6)
  
  #Door 3
  polygon(x=c(0.28,0.28,0.72,0.72),y=c(0.05,1,1,0.05),col="black",lwd=3)
  points(x=rep(0.5,9),y=rep(0.5,9),cex=c(9,11,8,8,10,7,6,8,5),pch=c(17,18,20),col=ColCode)
  polygon(x=c(0.4,0.4,0.72,0.72),y=c(0.18,0.855,1,0.05),col="darkgoldenrod",lwd=3)
  points(x=0.43,y=0.516,pch=19,cex=2)
  Fog(Position,Grid,Inventory)
  InteractFields(Inventory,Health,Strength)
  
  Pause(0.6)
  
  #Door 4
  polygon(x=c(0.28,0.28,0.72,0.72),y=c(0.05,1,1,0.05),col="black",lwd=3)
  points(x=rep(0.5,9),y=rep(0.5,9),cex=c(9,11,8,8,10,7,6,8,5),pch=c(17,18,20),col=ColCode)
  polygon(x=c(0.5,0.5,0.72,0.72),y=c(0.18,0.855,1,0.05),col="darkgoldenrod",lwd=3)
  points(x=0.53,y=0.516,pch=19,cex=1.5)
  Fog(Position,Grid,Inventory)
  InteractFields(Inventory,Health,Strength)

  
  Pause(0.6)
  
  #Door 5
  polygon(x=c(0.28,0.28,0.72,0.72),y=c(0.05,1,1,0.05),col="black",lwd=3)
  points(x=rep(0.5,9),y=rep(0.5,9),cex=c(9,11,8,8,10,7,6,8,5),pch=c(17,18,20),col=ColCode)
  polygon(x=c(0.6,0.6,0.72,0.72),y=c(0.25,0.80,1,0.05),col="darkgoldenrod",lwd=3)
  points(x=0.63,y=0.516,pch=19,cex=1.5)
  Fog(Position,Grid,Inventory)
  InteractFields(Inventory,Health,Strength)
  
  locator(1)
  
  run<-F
  
  return(list(run,Level))
}
#######################################################################################
#######################################################################################

rect(xleft=0.11,xright=0.89,ybottom=0.01,ytop=0.04,col="dodgerblue2",border=NA)

#Click-Game Function#
#####################
Click<-function(run,Grid,Map,Position,Inventory,Health,Strength,Level){
  
  while (run==T){
    
    #Scene
    Scene<-CreateView(Position,Grid,Map,Inventory)
    view<-Scene[[1]]
    Map<-Scene[[2]]
    
    BasicView(view)
    #
    MedikitDraw(view)   #Object 1
    KeyDraw(view)       #Object 2
    MapDraw(view)       #Object 3
    WoodDraw(view)      #Object 4
    HammerDraw(view)    #Object 5
    SwordDraw(view)     #Object 6
    TorchDraw(view)     #Object 8
    HoleDraw(view)      #Object 31
    HoleWoodDraw(view)  #Object 32 with Wood
    
    DrawWall.L1(view)
    DrawWall.L2(view)
    DrawWall.L3(view)
    DrawWall.L4(view)
    DrawWall.L5(view)
    
    Fog(Position,Grid,Inventory)
    
    InteractFields(Inventory,Health,Strength)
    
    action<-T
    
    #Check for Action

    if(Health<=0){action<-F;run<-F;Dead()} #Dead
    if(view[5,5]==31){action<-F;run<-F;Fall()} #Hole
    if(21 %in% view[c(5,4),c(4,5,6)] | 22 %in% view[c(5,4),c(4,5,6)] | 23 %in% view[c(5,4),c(4,5,6)]){ #Attacker around
      AttackerWakeUp(Inventory,Health,Strength,view,Position,Grid)
      Health<-Attack(x=0.5,y=0.5,view,Inventory,Health,Strength,Position,Grid)
      
      
      position.x<-which(Position==1, arr.ind = TRUE)[2] #First Def of Position
      position.y<-which(Position==1, arr.ind = TRUE)[1] #First Def of Position
      
      attacker.position.x<-which(Grid[c(position.y-1,position.y),c(position.x-1,position.x,position.x+1)] > 20 & Grid[c(position.y-1,position.y),c(position.x-1,position.x,position.x+1)]< 24, arr.ind = TRUE)[2] #First Def of Position
      attacker.position.y<-which(Grid[c(position.y-1,position.y),c(position.x-1,position.x,position.x+1)] > 20 & Grid[c(position.y-1,position.y),c(position.x-1,position.x,position.x+1)]< 24, arr.ind = TRUE)[1] #First Def of Position
      
      Grid[c(position.y-1,position.y)[attacker.position.y],c(position.x-1,position.x,position.x+1)[attacker.position.x]]<-77
                    
      if (Health<=0){action<-F}
    }    
    
    #Action
    if (action==T){
    cursor<-locator(1)
    
    #End Current Game
    if (0.91<cursor$x & 0.96>cursor$x & 0.93<cursor$y & cursor$y<1){
      run<-F
    } 
    
    if (0.46<cursor$x & 0.52>cursor$x & 0<cursor$y & cursor$y<0.09){
      #move forward
      Position<-MoveForward(Position,Grid)
    }
    
    if (0.38<cursor$x & 0.46>cursor$x & -0.02<cursor$y & cursor$y<0.04){  
      #turn left
      Grid<-rotate(Grid)
      Map<-rotate(Map)
      Position<-rotate(Position)
    }
    
    if (0.53<cursor$x & 0.61>cursor$x & -0.02<cursor$y & cursor$y<0.04){
      #turn right
      Grid<-rotate(rotate(rotate(Grid)))
      Map<-rotate(rotate(rotate(Map)))
      Position<-rotate(rotate(rotate(Position)))
    }
    
    if (0.2<cursor$x & 0.8>cursor$x & 0.1<cursor$y & cursor$y<0.45){
     PickSave<-PickUp(Inventory,Grid,Position)
     Grid<-PickSave[[1]]
     Inventory<-PickSave[[2]]
    }  
    
    
    if (-0.025<cursor$x & 0.275>cursor$x & 0.85<cursor$y & cursor$y<0.95){
      #Use Inventory
      SaveInvent<-UseInventory(cursor,Inventory,view,Health,Strength,Grid,Position,Map)
      Health<-SaveInvent[[1]]
      Strength<-SaveInvent[[2]]
      Grid<-SaveInvent[[3]]
      Inventory<-SaveInvent[[4]]
      run<-SaveInvent[[5]]
      Level<-SaveInvent[[6]]
    }  
  
    #Life
    if (Health>1){Health<-1}
    if (Health<0){Health<-0}
    #Strength
    if (Strength>1){Strength<-1}
    }
  }
  return(Level)
}
#######################################################################################
#######################################################################################

rect(xleft=0.11,xright=0.89,ybottom=0.01,ytop=0.04,col="dodgerblue2",border=NA)
Pause(1)
dev.off()


#Intro Sequence
Intro()
Game<-T
Level<-1

#Choose a Level
while(Game==T){

Chosen<-ChooseLevel(Level) #return(list(Game,run,Grid,Health,Strength,Inventory))

Game<-Chosen[[1]]
run<-Chosen[[2]]
Grid<-Chosen[[3]]
Position<-Chosen[[4]]
Map<-Chosen[[5]]
Health<-Chosen[[6]]
Strength<-Chosen[[7]]
Inventory<-Chosen[[8]]
Level<-Chosen[[9]]
Text<-Chosen[[10]]

Title(Text)
Level<-Click(run,Grid,Map,Position,Inventory,Health,Strength,Level)
}
